



<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <title>nasldoc: nasl</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!-- Le styles -->
  <style type="text/css">
	body {
	padding-top: 60px;
	padding-bottom: 40px;
	}
	.sidebar-nav {
	padding: 9px 0;
	}
  </style>

  <link href="css/bootstrap.min.css" rel="stylesheet">
  <link href="css/shCore.css" rel="stylesheet" type="text/css" />
  <link href="css/shThemeDefault.css" rel="stylesheet" type="text/css" />

  <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
  <!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <!-- Fav and touch icons -->
  <link rel="shortcut icon" href="ico/favicon.ico">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="ico/apple-touch-icon-144-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="ico/apple-touch-icon-114-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="ico/apple-touch-icon-72-precomposed.png">
  <link rel="apple-touch-icon-precomposed" href="ico/apple-touch-icon-57-precomposed.png">
  </head>

  <body>

	<div class="navbar navbar-inverse navbar-fixed-top">
	  <div class="navbar-inner">
		<div class="container-fluid">
		  <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
		  </a>
		  <a class="brand" href="index.html">nasldoc</a>
		  <div class="nav-collapse collapse">
			<ul class="nav">
			  <li class="active"><a href="index.html">Home</a></li>
			</ul>
		  </div><!--/.nav-collapse -->
		</div>
	  </div>
	</div>

  <div class="container-fluid">
	<div class="row-fluid">
	<div class="span3">
	  <div class="well sidebar-nav">
	  <ul class="nav nav-list">
		
			
			
			<li class="even">
			  <a href="GSHB_BruteForce.html">GSHB_BruteForce.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="GSHB_read_file.html">GSHB_read_file.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="bad_ssh_host_keys.html">bad_ssh_host_keys.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="bad_ssh_keys.html">bad_ssh_keys.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="bin.html">bin.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="byte_func.html">byte_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="cisco_ios.html">cisco_ios.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="cpe.html">cpe.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="default_account.html">default_account.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="default_credentials.html">default_credentials.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="dump.html">dump.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="ftp_func.html">ftp_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="gb_openssl_heartbeat.html">gb_openssl_heartbeat.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="global_settings.html">global_settings.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="gvr_apps_auth_func.html">gvr_apps_auth_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="host_details.html">host_details.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="hp_printers.html">hp_printers.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="http_func.html">http_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="http_keepalive.html">http_keepalive.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="imap_func.html">imap_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="itg.html">itg.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="junos.html">junos.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="kyocera_printers.html">kyocera_printers.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="ldap.html">ldap.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="lexmark_printers.html">lexmark_printers.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="misc_func.html">misc_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="netop.html">netop.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="network_func.html">network_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="nfs_func.html">nfs_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="nmap.html">nmap.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="nntp_func.html">nntp_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="os_eol.html">os_eol.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="pingpong.html">pingpong.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="pkg-lib-bsd.html">pkg-lib-bsd.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="pkg-lib-deb.html">pkg-lib-deb.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="pkg-lib-gentoo.html">pkg-lib-gentoo.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="pkg-lib-hpux.html">pkg-lib-hpux.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="pkg-lib-macosx.html">pkg-lib-macosx.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="pkg-lib-rpm.html">pkg-lib-rpm.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="pkg-lib-slack.html">pkg-lib-slack.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="pop3_func.html">pop3_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="revisions-lib.html">revisions-lib.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="rsync_func.html">rsync_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="secpod_activex.html">secpod_activex.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="secpod_ie_supersede.html">secpod_ie_supersede.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="secpod_reg.html">secpod_reg.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="secpod_smb_func.html">secpod_smb_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="secpod_ssl_ciphers.html">secpod_ssl_ciphers.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="sharp_printers.html">sharp_printers.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="sip.html">sip.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="smb_default_credentials.html">smb_default_credentials.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="smb_nt.html">smb_nt.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="smbcl_func.html">smbcl_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="smtp_func.html">smtp_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="snmp_func.html">snmp_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="solaris.html">solaris.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="ssh_func.html">ssh_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="ssl_funcs.html">ssl_funcs.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="telnet_func.html">telnet_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="tftp.html">tftp.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="uddi.html">uddi.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="url_func.html">url_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="version_func.html">version_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="vmware_esx.html">vmware_esx.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="wmi_file.html">wmi_file.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="wmi_hardware.html">wmi_hardware.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="wmi_misc.html">wmi_misc.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="wmi_os.html">wmi_os.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="wmi_proc.html">wmi_proc.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="wmi_rsop.html">wmi_rsop.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="wmi_svc.html">wmi_svc.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="wmi_user.html">wmi_user.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="wordlist.html">wordlist.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="xerox_printers.html">xerox_printers.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="xml.html">xml.inc</a>
			</li>
		
	  </ul>
	  </div><!--/.well -->
	</div><!--/span-->
	<div class="span9">

		<a name="top"></a>
		<h1>Overview of secpod_reg.inc</h1>
		

		

		<h1>Automatic Includes</h1>
		<p>These files are automatically included by the library.</p>
		<ul>
		  
		  <li><a href="global_settings.html">global_settings.inc</a></li>
		  
		</ul>
		

		
		
		
		
		

		
		
		<h1>Public Function Summary</h1>

		
		<p>Public functions are intended to be called by the code that imports
		this library.</p>
		

		<table class="nopad">
		  <tr class="TableHeadingColor">
			<th>Name</th>
			<th>Summary</th>
		  </tr>
		  
		  <tr>
			<td><a href="#hotfix_check_domain_controler">hotfix_check_domain_controler</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#hotfix_check_exchange_installed">hotfix_check_exchange_installed</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#hotfix_check_iis_installed">hotfix_check_iis_installed</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#hotfix_check_nt_server">hotfix_check_nt_server</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#hotfix_check_sp">hotfix_check_sp</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#hotfix_missing">hotfix_missing</a></td>
			<td></td>
		  </tr>
		  
		</table>
		
		
		
		

		
		
		
		
		

		
		
		<h1>Public Function Details</h1>
		
		<h2 id="hotfix_check_domain_controler">hotfix_check_domain_controler</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function hotfix_check_domain_controler()
{
  local_var product_options;
  product_options = get_kb_item(&quot;SMB/Registry/HKLM/SYSTEM/CurrentControlSet/Control/ProductOptions&quot;);
  if(!product_options){
    return -1;
  }
  if(&quot;LanmanNT&quot; &gt;&lt; product_options)
    return 1;
  else return 0;
}

function hotfix_check_nt_server()

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="hotfix_check_exchange_installed">hotfix_check_exchange_installed</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function hotfix_check_exchange_installed()
{
  local_var vers;
  vers = get_kb_item(&quot;SMB/Registry/HKLM/SOFTWARE/Microsoft/Exchange/Setup/ServicePackBuild&quot;);
  if(!vers)
    return NULL;
  else return vers;
}

function hotfix_check_iis_installed()

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="hotfix_check_iis_installed">hotfix_check_iis_installed</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function hotfix_check_iis_installed()
{
  local_var w3svc;
  w3svc = get_kb_item(&quot;SMB/Registry/HKLM/SYSTEM/CurrentControlSet/Services/W3SVC/ImagePath&quot;);
  if(!w3svc){
    return -1;
  }
  if(&quot;inetinfo&quot; &gt;!&lt; w3svc)
    return 0;
  else return 1;
}


		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="hotfix_check_nt_server">hotfix_check_nt_server</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function hotfix_check_nt_server()
{
  local_var product_options;
  product_options = get_kb_item(&quot;SMB/Registry/HKLM/SYSTEM/CurrentControlSet/Control/ProductOptions&quot;);
  if(!product_options){
    return -1;
  }
  if(&quot;WinNT&quot; &gt;&lt; product_options)
    return 0;
  else return 1;
}

function hotfix_check_exchange_installed()

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="hotfix_check_sp">hotfix_check_sp</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>nt</dt>
			
		
			<dt>win10</dt>
			
		
			<dt>win10x64</dt>
			
		
			<dt>win2003</dt>
			
		
			<dt>win2003x64</dt>
			
		
			<dt>win2008</dt>
			
		
			<dt>win2008r2</dt>
			
		
			<dt>win2012</dt>
			
		
			<dt>win2012R2</dt>
			
		
			<dt>win2k</dt>
			
		
			<dt>win7</dt>
			
		
			<dt>win7x64</dt>
			
		
			<dt>win8</dt>
			
		
			<dt>win8_1</dt>
			
		
			<dt>win8_1x64</dt>
			
		
			<dt>win8x64</dt>
			
		
			<dt>winVista</dt>
			
		
			<dt>xp</dt>
			
		
			<dt>xpx64</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
 function hotfix_check_sp(nt, win2k, xp, xpx64, win2003, win2003x64, winVista,
                         win7, win7x64, win2008, win2008r2, win8, win8x64, win2012, 
                         win2012R2, win8_1, win8_1x64, win10, win10x64)
 {
 	local_var winVer, SvPk;

  	winVer = get_kb_item(&quot;SMB/WindowsVersion&quot;);
        winName = get_kb_item(&quot;SMB/WindowsName&quot;);
        arch = get_kb_item(&quot;SMB/Windows/Arch&quot;);
  	if(!winVer){
		return -1;
	}

   	if(nt &amp;&amp; (&quot;4.0&quot; &gt;&lt; winVer))
  	{
    		SvPk = get_kb_item(&quot;SMB/WinNT4/ServicePack&quot;);
		if(SvPk){
    			SvPk = int(ereg_replace(string:SvPk, replace:&quot;\1&quot;,
			 	        pattern:&quot;.*Service Pack ([0-9]).*&quot;));
		}
    		else {
			SvPk = 0;
		}

    		if(SvPk &lt; nt){
			return 1;
		}
		else {
			return 0;
		}
  	}

  	else if(win2k &amp;&amp; (&quot;5.0&quot; &gt;&lt; winVer) &amp;&amp; (&quot;Microsoft Windows 2000&quot; &gt;&lt; winName))
  	{
    		SvPk = get_kb_item(&quot;SMB/Win2K/ServicePack&quot;);
    		if(SvPk){
			SvPk = int(ereg_replace(string:SvPk, replace:&quot;\1&quot;,
			 		pattern:&quot;.*Service Pack ([0-9]).*&quot;));
		}
    		else {
			SvPk = 0;
		}

		if(SvPk &lt; win2k ){
			return 1;
		}
    		else {
			return 0;
		}
  	}

	else if(xp &amp;&amp; (&quot;5.1&quot; &gt;&lt; winVer) &amp;&amp; (&quot;Microsoft Windows XP&quot; &gt;&lt; winName))
	{
		SvPk = get_kb_item(&quot;SMB/WinXP/ServicePack&quot;);
		if(SvPk){
			SvPk = int(ereg_replace(string:SvPk, replace:&quot;\1&quot;,
					pattern:&quot;.*Service Pack ([0-9]).*&quot;));
		}
    		else {
			SvPk = 0;
		}

		if(SvPk &lt; xp){
			return 1;
		}
		else {
			return 0;
		}
  	}

        else if(xpx64 &amp;&amp; (&quot;5.2&quot; &gt;&lt; winVer) &amp;&amp; (&quot;Microsoft Windows XP&quot; &gt;&lt; winName) &amp;&amp; (arch == &quot;x64&quot;))
        {
                SvPk = get_kb_item(&quot;SMB/WinXPx64/ServicePack&quot;);
                if(SvPk){
                        SvPk = int(ereg_replace(string:SvPk, replace:&quot;\1&quot;,
                                        pattern:&quot;.*Service Pack ([0-9]).*&quot;));
                }
                else {
                        SvPk = 0;
                }

                if(SvPk &lt; xpx64){
                        return 1;
                }
                else {
                        return 0;
                }
        }

  	else if(win2003 &amp;&amp;  (&quot;5.2&quot; &gt;&lt; winVer) &amp;&amp; (&quot;Microsoft Windows Server 2003&quot; &gt;&lt; winName) &amp;&amp; (arch == &quot;x86&quot;))
  	{
    		SvPk = get_kb_item(&quot;SMB/Win2003/ServicePack&quot;);
    		if(SvPk){
			SvPk = int(ereg_replace(string:SvPk, replace:&quot;\1&quot;,
				 	pattern:&quot;.*Service Pack ([0-9]).*&quot;));
		}
		else {
			SvPk = 0;
		}

    		if(SvPk &lt; win2003){
			return 1;
		}
		else {
			return 0;
		}
  	}

        else if(win2003x64 &amp;&amp; (&quot;5.2&quot; &gt;&lt; winVer) &amp;&amp; (&quot;Microsoft Windows Server 2003&quot; &gt;&lt; winName) &amp;&amp; (arch == &quot;x64&quot;))
        {
                SvPk = get_kb_item(&quot;SMB/Win2003x64/ServicePack&quot;);
                if(SvPk){
                        SvPk = int(ereg_replace(string:SvPk, replace:&quot;\1&quot;,
                                        pattern:&quot;.*Service Pack ([0-9]).*&quot;));
                }
                else {
                        SvPk = 0;
                }

                if(SvPk &lt; win2003x64){
                        return 1;
                }
                else {
                        return 0;
                }
        }

        else if(winVista &amp;&amp;  (&quot;6.0&quot; &gt;&lt; winVer) &amp;&amp; (&quot;Windows Vista&quot; &gt;&lt; winName))
        {
                SvPk = get_kb_item(&quot;SMB/WinVista/ServicePack&quot;);
                if(SvPk){
                        SvPk = int(ereg_replace(string:SvPk, replace:&quot;\1&quot;,
                                        pattern:&quot;.*Service Pack ([0-9]).*&quot;));
                }
                else {
                        SvPk = 0;
                }

                if(SvPk &lt; winVista){
                        return 1;
                }
                else {
                        return 0;
                }

        }

        else if(win7 &amp;&amp;  (&quot;6.1&quot; &gt;&lt; winVer) &amp;&amp; (&quot;Windows 7&quot; &gt;&lt; winName) &amp;&amp; (arch == &quot;x86&quot;))
        {
                SvPk = get_kb_item(&quot;SMB/Win7/ServicePack&quot;);
                if(SvPk){
                        SvPk = int(ereg_replace(string:SvPk, replace:&quot;\1&quot;,
                                        pattern:&quot;.*Service Pack ([0-9]).*&quot;));
                }
                else {
                        SvPk = 0;
                }

                if(SvPk &lt; win7){
                        return 1;
                }
                else {
                        return 0;
                }

        }

        else if(win7x64 &amp;&amp;  (&quot;6.1&quot; &gt;&lt; winVer) &amp;&amp; (&quot;Windows 7&quot; &gt;&lt; winName) &amp;&amp; (arch == &quot;x64&quot;))
        {
                SvPk = get_kb_item(&quot;SMB/Win7x64/ServicePack&quot;);
                if(SvPk){
                        SvPk = int(ereg_replace(string:SvPk, replace:&quot;\1&quot;,
                                        pattern:&quot;.*Service Pack ([0-9]).*&quot;));
                }
                else {
                        SvPk = 0;
                }

                if(SvPk &lt; win7x64){
                        return 1;
                }
                else {
                        return 0;
                }

        }

        else if(win2008 &amp;&amp;  (&quot;6.0&quot; &gt;&lt; winVer) &amp;&amp; (&quot;Windows Server (R) 2008&quot; &gt;&lt; winName))
        {
                SvPk = get_kb_item(&quot;SMB/Win2008/ServicePack&quot;);
                if(SvPk){
                        SvPk = int(ereg_replace(string:SvPk, replace:&quot;\1&quot;,
                                        pattern:&quot;.*Service Pack ([0-9]).*&quot;));
                }
                else {
                        SvPk = 0;
                }

                if(SvPk &lt; win2008){
                        return 1;
                }
                else {
                        return 0;
                }

        }

	else if(win2008r2 &amp;&amp;  (&quot;6.1&quot; &gt;&lt; winVer) &amp;&amp; (&quot;Windows Server 2008 R2&quot; &gt;&lt; winName) &amp;&amp; (arch == &quot;x64&quot;))
        {
                SvPk = get_kb_item(&quot;SMB/Win2008R2/ServicePack&quot;);
                if(SvPk){
                        SvPk = int(ereg_replace(string:SvPk, replace:&quot;\1&quot;,
                                        pattern:&quot;.*Service Pack ([0-9]).*&quot;));
                }
                else {
                        SvPk = 0;
                }

                if(SvPk &lt; win2008r2){
                        return 1;
                }
                else {
                        return 0;
                }
        }
        
        else if(win8 &amp;&amp;  (&quot;6.2&quot; &gt;&lt; winVer) &amp;&amp; (&quot;Windows 8&quot; &gt;&lt; winName) &amp;&amp; (arch == &quot;x86&quot;))
        {
                SvPk = get_kb_item(&quot;SMB/Win8/ServicePack&quot;);
                if(SvPk){
                        SvPk = int(ereg_replace(string:SvPk, replace:&quot;\1&quot;,
                                        pattern:&quot;.*Service Pack ([0-9]).*&quot;));
                }
                else {
                        SvPk = 0;
                }

                if(SvPk &lt; win8){
                        return 1;
                }
                else {
                        return 0;
                }
        }

        else if(win8x64 &amp;&amp;  (&quot;6.2&quot; &gt;&lt; winVer) &amp;&amp; (&quot;Windows 8&quot; &gt;&lt; winName) &amp;&amp; (arch == &quot;x64&quot;))
        {
                SvPk = get_kb_item(&quot;SMB/Win8x64/ServicePack&quot;);
                if(SvPk){
                        SvPk = int(ereg_replace(string:SvPk, replace:&quot;\1&quot;,
                                        pattern:&quot;.*Service Pack ([0-9]).*&quot;));
                }
                else {
                        SvPk = 0;
                }

                if(SvPk &lt; win8x64){
                        return 1;
                }
                else {
                        return 0;
                }
        }
        
        else if(win2012 &amp;&amp;  (&quot;6.2&quot; &gt;&lt; winVer) &amp;&amp; (&quot;Windows Server 2012&quot; &gt;&lt; winName) &amp;&amp; (arch == &quot;x64&quot;))
        {
                SvPk = get_kb_item(&quot;SMB/Win2012/ServicePack&quot;);
                if(SvPk){
                        SvPk = int(ereg_replace(string:SvPk, replace:&quot;\1&quot;,
                                        pattern:&quot;.*Service Pack ([0-9]).*&quot;));
                }
                else {
                        SvPk = 0;
                }

                if(SvPk &lt; win2012){
                        return 1;
                }
                else {
                        return 0;
                }
        }

        else if(win2012R2 &amp;&amp;  (&quot;6.3&quot; &gt;&lt; winVer) &amp;&amp; (&quot;Windows Server 2012 R2&quot; &gt;&lt; winName) &amp;&amp; (arch == &quot;x64&quot;))
        {
                SvPk = get_kb_item(&quot;SMB/Win2012R2/ServicePack&quot;);
                if(SvPk){
                        SvPk = int(ereg_replace(string:SvPk, replace:&quot;\1&quot;,
                                        pattern:&quot;.*Service Pack ([0-9]).*&quot;));
                }
                else {
                        SvPk = 0;
                }

                if(SvPk &lt; win2012R2){
                        return 1;
                }
                else {
                        return 0;
                }
        }

        else if(win8_1 &amp;&amp;  (&quot;6.3&quot; &gt;&lt; winVer) &amp;&amp; (&quot;Windows 8.1&quot; &gt;&lt; winName) &amp;&amp; (arch == &quot;x86&quot;))
        {
                SvPk = get_kb_item(&quot;SMB/Win8.1/ServicePack&quot;);
                if(SvPk){
                        SvPk = int(ereg_replace(string:SvPk, replace:&quot;\1&quot;,
                                        pattern:&quot;.*Service Pack ([0-9]).*&quot;));
                }
                else {
                        SvPk = 0;
                }

                if(SvPk &lt; win8_1){
                        return 1;
                }
                else {
                        return 0;
                }
        }

        else if(win8_1x64 &amp;&amp;  (&quot;6.3&quot; &gt;&lt; winVer) &amp;&amp; (&quot;Windows 8.1&quot; &gt;&lt; winName) &amp;&amp; (arch == &quot;x64&quot;))
        {
                SvPk = get_kb_item(&quot;SMB/Win8.1x64/ServicePack&quot;);
                if(SvPk){
                        SvPk = int(ereg_replace(string:SvPk, replace:&quot;\1&quot;,
                                        pattern:&quot;.*Service Pack ([0-9]).*&quot;));
                }
                else {
                        SvPk = 0;
                }
 
                if(SvPk &lt; win8_1x64){
                        return 1;
                }
                else {
                        return 0;
                }
        }

       else if(win10 &amp;&amp;  (&quot;6.3&quot; &gt;&lt; winVer) &amp;&amp; (&quot;Windows 10&quot; &gt;&lt; winName) &amp;&amp; (arch == &quot;x86&quot;))
        {
                SvPk = get_kb_item(&quot;SMB/Win10/ServicePack&quot;);
                if(SvPk){
                        SvPk = int(ereg_replace(string:SvPk, replace:&quot;\1&quot;,
                                        pattern:&quot;.*Service Pack ([0-9]).*&quot;));
                }
                else {
                        SvPk = 0;
                }

                if(SvPk &lt; win10){
                        return 1;
                }
                else {
                        return 0;
                }
        }

        else if(win10x64 &amp;&amp;  (&quot;6.3&quot; &gt;&lt; winVer) &amp;&amp; (&quot;Windows 10&quot; &gt;&lt; winName) &amp;&amp; (arch == &quot;x64&quot;))
        {
                SvPk = get_kb_item(&quot;SMB/Win10x64/ServicePack&quot;);
                if(SvPk){
                        SvPk = int(ereg_replace(string:SvPk, replace:&quot;\1&quot;,
                                        pattern:&quot;.*Service Pack ([0-9]).*&quot;));
                }
                else {
                        SvPk = 0;
                }

                if(SvPk &lt; win10x64){
                        return 1;
                }
                else {
                        return 0;
                }
        }
   
       return -1;
 }

 #-----------------------------------------------------------------------------

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="hotfix_missing">hotfix_missing</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>name</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
 function hotfix_missing(name)
 {
       local_var KB, key;

      KB = get_kb_list(&quot;SMB/Registry/*&quot;);
      if(isnull(KB) || max_index(make_list(keys(KB))) == 0){
 		return -1;
 	}

 	if(&quot;KB&quot; &gt;&lt; name){
		name -= &quot;KB&quot;;
 	}
 	else if(&quot;Q&quot; &gt;&lt; name){
		name -= &quot;Q&quot;;
 	}
 	else if(&quot;M&quot; &gt;&lt; name){
		name -= &quot;M&quot;;
	}

 	foreach key (keys(KB))
 	{
                if(ereg(pattern:&quot;SMB/Registry/HKLM/SOFTWARE/Microsoft/(Updates/.*|&quot; +
                                &quot;Windows NT/CurrentVersion/HotFix)/(KB|Q|M)&quot; + name,
                        string:key) ){
                        return 0;
                }
                else if(ereg(pattern:&quot;SMB/Registry/HKLM/SOFTWARE/Microsoft/Windows/&quot; +
                                     &quot;CurrentVersion/Component Based Servicing/&quot; +
                                     &quot;Packages/[P|P]ackage.?[0-9].?for.?KB.*&quot; + name, string:key)){
                     return 0;
                }
  	}
      return 1;
}


function hotfix_check_domain_controler()

		</pre>
		<a href="#top">top</a>
		<hr>
		
		
		
		
		

	</div><!--/span-->
	</div><!--/row-->

	<hr>

	<footer>
		<p>&copy; Tenable Network Security 2014</p>
	</footer>

  </div><!--/.fluid-container-->

  <!-- Le javascript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script type="text/javascript" src="js/jquery-1.8.2.js"></script>
  <script type="text/javascript" src="js/bootstrap.min.js"></script>
  <script type="text/javascript" src="js/shCore.js"></script>
  <script type="text/javascript" src="js/shBrushNasl.js"></script>

  <script type="text/javascript">
    SyntaxHighlighter.defaults['collapse'] = true;
    SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.all();
  </script>

  </body>
</html>
