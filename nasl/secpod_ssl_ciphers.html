



<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <title>nasldoc: nasl</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!-- Le styles -->
  <style type="text/css">
	body {
	padding-top: 60px;
	padding-bottom: 40px;
	}
	.sidebar-nav {
	padding: 9px 0;
	}
  </style>

  <link href="css/bootstrap.min.css" rel="stylesheet">
  <link href="css/shCore.css" rel="stylesheet" type="text/css" />
  <link href="css/shThemeDefault.css" rel="stylesheet" type="text/css" />

  <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
  <!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <!-- Fav and touch icons -->
  <link rel="shortcut icon" href="ico/favicon.ico">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="ico/apple-touch-icon-144-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="ico/apple-touch-icon-114-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="ico/apple-touch-icon-72-precomposed.png">
  <link rel="apple-touch-icon-precomposed" href="ico/apple-touch-icon-57-precomposed.png">
  </head>

  <body>

	<div class="navbar navbar-inverse navbar-fixed-top">
	  <div class="navbar-inner">
		<div class="container-fluid">
		  <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
		  </a>
		  <a class="brand" href="index.html">nasldoc</a>
		  <div class="nav-collapse collapse">
			<ul class="nav">
			  <li class="active"><a href="index.html">Home</a></li>
			</ul>
		  </div><!--/.nav-collapse -->
		</div>
	  </div>
	</div>

  <div class="container-fluid">
	<div class="row-fluid">
	<div class="span3">
	  <div class="well sidebar-nav">
	  <ul class="nav nav-list">
		
			
			
			<li class="even">
			  <a href="GSHB_BruteForce.html">GSHB_BruteForce.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="GSHB_read_file.html">GSHB_read_file.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="bad_ssh_host_keys.html">bad_ssh_host_keys.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="bad_ssh_keys.html">bad_ssh_keys.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="bin.html">bin.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="byte_func.html">byte_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="cisco_ios.html">cisco_ios.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="cpe.html">cpe.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="default_account.html">default_account.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="default_credentials.html">default_credentials.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="dump.html">dump.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="ftp_func.html">ftp_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="gb_openssl_heartbeat.html">gb_openssl_heartbeat.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="global_settings.html">global_settings.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="gvr_apps_auth_func.html">gvr_apps_auth_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="host_details.html">host_details.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="hp_printers.html">hp_printers.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="http_func.html">http_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="http_keepalive.html">http_keepalive.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="imap_func.html">imap_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="itg.html">itg.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="junos.html">junos.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="kyocera_printers.html">kyocera_printers.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="ldap.html">ldap.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="lexmark_printers.html">lexmark_printers.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="misc_func.html">misc_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="netop.html">netop.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="network_func.html">network_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="nfs_func.html">nfs_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="nmap.html">nmap.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="nntp_func.html">nntp_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="os_eol.html">os_eol.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="pingpong.html">pingpong.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="pkg-lib-bsd.html">pkg-lib-bsd.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="pkg-lib-deb.html">pkg-lib-deb.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="pkg-lib-gentoo.html">pkg-lib-gentoo.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="pkg-lib-hpux.html">pkg-lib-hpux.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="pkg-lib-macosx.html">pkg-lib-macosx.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="pkg-lib-rpm.html">pkg-lib-rpm.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="pkg-lib-slack.html">pkg-lib-slack.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="pop3_func.html">pop3_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="revisions-lib.html">revisions-lib.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="rsync_func.html">rsync_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="secpod_activex.html">secpod_activex.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="secpod_ie_supersede.html">secpod_ie_supersede.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="secpod_reg.html">secpod_reg.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="secpod_smb_func.html">secpod_smb_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="secpod_ssl_ciphers.html">secpod_ssl_ciphers.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="sharp_printers.html">sharp_printers.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="sip.html">sip.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="smb_default_credentials.html">smb_default_credentials.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="smb_nt.html">smb_nt.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="smbcl_func.html">smbcl_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="smtp_func.html">smtp_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="snmp_func.html">snmp_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="solaris.html">solaris.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="ssh_func.html">ssh_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="ssl_funcs.html">ssl_funcs.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="telnet_func.html">telnet_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="tftp.html">tftp.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="uddi.html">uddi.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="url_func.html">url_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="version_func.html">version_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="vmware_esx.html">vmware_esx.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="wmi_file.html">wmi_file.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="wmi_hardware.html">wmi_hardware.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="wmi_misc.html">wmi_misc.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="wmi_os.html">wmi_os.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="wmi_proc.html">wmi_proc.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="wmi_rsop.html">wmi_rsop.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="wmi_svc.html">wmi_svc.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="wmi_user.html">wmi_user.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="wordlist.html">wordlist.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="xerox_printers.html">xerox_printers.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="xml.html">xml.inc</a>
			</li>
		
	  </ul>
	  </div><!--/.well -->
	</div><!--/span-->
	<div class="span9">

		<a name="top"></a>
		<h1>Overview of secpod_ssl_ciphers.inc</h1>
		

		

		
		
		
		
		

		
		
		<h1>Public Function Summary</h1>

		
		<p>Public functions are intended to be called by the code that imports
		this library.</p>
		

		<table class="nopad">
		  <tr class="TableHeadingColor">
			<th>Name</th>
			<th>Summary</th>
		  </tr>
		  
		  <tr>
			<td><a href="#check_sslv2_cipher_spec_supported">check_sslv2_cipher_spec_supported</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#check_sslv3_cipher_spec_supported">check_sslv3_cipher_spec_supported</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#check_tlsv1_1_cipher_spec_supported">check_tlsv1_1_cipher_spec_supported</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#check_tlsv1_2_cipher_spec_supported">check_tlsv1_2_cipher_spec_supported</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#check_tlsv1_cipher_spec_supported">check_tlsv1_cipher_spec_supported</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#construct_ssl_req">construct_ssl_req</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#get_ssl_server_hello">get_ssl_server_hello</a></td>
			<td></td>
		  </tr>
		  
		</table>
		
		
		
		

		
		
		
		
		

		
		
		<h1>Public Function Details</h1>
		
		<h2 id="check_sslv2_cipher_spec_supported">check_sslv2_cipher_spec_supported</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>server_hello</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function check_sslv2_cipher_spec_supported(server_hello)
{
  ## SSLv2 Server Hello Structure
  ## Length(2), ServerHelo(1), SessionIDHit(1), CertificateType(1), SSLVer(2),
  ## CertificateLength(2), CipherLength(2), ConnIDLength(2),
  ## Certificate(CertificateLength)
  ## CipherSpec(CipherLength),
  ## ConnID(ConnIDLength)

  sslv2_cipher_sup = FALSE;

  ## Check for ServerHello(4), SSL Ver(0x0002), Cipher Spec Length(3)
  ## If all the conditions specified menas, given cipher spec is supported
  ## by server
  if(ord(server_hello[2]) == 4 &amp;&amp; ord(server_hello[5]) == 0 &amp;&amp; ord(server_hello[6]) == 2 &amp;&amp;
     ord(server_hello[9]) == 0 &amp;&amp; ord(server_hello[10]) == 3){
    sslv2_cipher_sup = TRUE;
  }
  return(sslv2_cipher_sup);
}


## This function check for certain bytes in the server_hello and

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="check_sslv3_cipher_spec_supported">check_sslv3_cipher_spec_supported</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>server_hello</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function check_sslv3_cipher_spec_supported(server_hello)
{

  ## ServerHello :
  ## HandshakeType(1), SSLVer(2), Length(2), ServerHello(1), Length(3)
  ## SSLVer(2), RandomData(32),
  ## SessionIDLength(1), SessionID(SessionIDLength)
  ## CipherSuite(Client-CipherSuitLength)
  ## CompressionMethod(1)
  ##
  ## Certificate :
  ## HandshakeType(1), SSLVer(2), Length(2), Certificate(1), Length(3)
  ## CertificatesLength(3), CertificateLength(3), Certificate(CertificateLength)
  ##
  ## ServerKey Exchange
  ## HandshakeType(1), SSLVer(2), Length(2), ServerKeyExchange(1), Length(3)
  ##
  ## ServerHello Done
  ## HandshakeType(1), SSLVer(2), Length(2), ServerHelloDone(1), Length(3)

  sslv3_cipher_sup = FALSE;

  ## Check for ServerHello(4), SSL Ver(0x0002), Cipher Spec Length(3)
  ## If all the conditions specified menas, given cipher spec is supported
  ## by server
  if(ord(server_hello[0]) == 22 &amp;&amp; ord(server_hello[1]) == 3 &amp;&amp; ord(server_hello[2]) == 0 &amp;&amp;
     ord(server_hello[5]) == 2 &amp;&amp;  ord(server_hello[9]) == 3){
    sslv3_cipher_sup = TRUE;
  }
  return(sslv3_cipher_sup);
}

## This function check for certain bytes in the server_hello and

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="check_tlsv1_1_cipher_spec_supported">check_tlsv1_1_cipher_spec_supported</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>server_hello</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function check_tlsv1_1_cipher_spec_supported(server_hello)
{

  ## ServerHello :
  ## HandshakeType(1), SSLVer(2), Length(2), ServerHello(1), Length(3)
  ## SSLVer(2), RandomData(32),
  ## SessionIDLength(1), SessionID(SessionIDLength)
  ## CipherSuite(Client-CipherSuitLength)
  ## CompressionMethod(1)
  ##
  ## Certificate :
  ## HandshakeType(1), SSLVer(2), Length(2), Certificate(1), Length(3)
  ## CertificatesLength(3), CertificateLength(3), Certificate(CertificateLength)
  ##
  ## ServerKey Exchange
  ## HandshakeType(1), SSLVer(2), Length(2), ServerKeyExchange(1), Length(3)
  ##
  ## ServerHello Done
  ## HandshakeType(1), SSLVer(2), Length(2), ServerHelloDone(1), Length(3)

  tlsv1_1_cipher_sup = FALSE;

  ## Check for ServerHello(4), SSL Ver(0x0002), Cipher Spec Length(3)
  ## If all the conditions specified menas, given cipher spec is supported
  ## by server
  if(ord(server_hello[0]) == 22 &amp;&amp; ord(server_hello[1]) == 3 &amp;&amp; ord(server_hello[2]) == 2 &amp;&amp;
     ord(server_hello[5]) == 2 &amp;&amp;  ord(server_hello[9]) == 3 &amp;&amp; ord(server_hello[10]) == 2){
    tlsv1_1_cipher_sup = TRUE;
  }
  return(tlsv1_1_cipher_sup);
}

## This function check for certain bytes in the server_hello and

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="check_tlsv1_2_cipher_spec_supported">check_tlsv1_2_cipher_spec_supported</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>server_hello</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function check_tlsv1_2_cipher_spec_supported(server_hello)
{
  ## ServerHello :
  ## HandshakeType(1), SSLVer(2), Length(2), ServerHello(1), Length(3)
  ## SSLVer(2), RandomData(32),
  ## SessionIDLength(1), SessionID(SessionIDLength)
  ## CipherSuite(Client-CipherSuitLength)
  ## CompressionMethod(1)
  ##
  ## Certificate :
  ## HandshakeType(1), SSLVer(2), Length(2), Certificate(1), Length(3)
  ## CertificatesLength(3), CertificateLength(3), Certificate(CertificateLength)
  ##
  ## ServerKey Exchange
  ## HandshakeType(1), SSLVer(2), Length(2), ServerKeyExchange(1), Length(3)
  ##
  ## ServerHello Done
  ## HandshakeType(1), SSLVer(2), Length(2), ServerHelloDone(1), Length(3)

  tlsv1_2_cipher_sup = FALSE;

  ## Check for ServerHello(4), SSL Ver(0x0002), Cipher Spec Length(3)
  ## If all the conditions specified menas, given cipher spec is supported
  ## by server
  if(ord(server_hello[0]) == 22 &amp;&amp; ord(server_hello[1]) == 3 &amp;&amp; ord(server_hello[2]) == 3 &amp;&amp;
     ord(server_hello[5]) == 2 &amp;&amp;  ord(server_hello[9]) == 3 &amp;&amp;  ord(server_hello[10]) == 3){
    tlsv1_2_cipher_sup = TRUE;
  }
  return(tlsv1_2_cipher_sup);
}



		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="check_tlsv1_cipher_spec_supported">check_tlsv1_cipher_spec_supported</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>server_hello</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function check_tlsv1_cipher_spec_supported(server_hello)
{

  ## ServerHello :
  ## HandshakeType(1), SSLVer(2), Length(2), ServerHello(1), Length(3)
  ## SSLVer(2), RandomData(32),
  ## SessionIDLength(1), SessionID(SessionIDLength)
  ## CipherSuite(Client-CipherSuitLength)
  ## CompressionMethod(1)
  ##
  ## Certificate :
  ## HandshakeType(1), SSLVer(2), Length(2), Certificate(1), Length(3)
  ## CertificatesLength(3), CertificateLength(3), Certificate(CertificateLength)
  ##
  ## ServerKey Exchange
  ## HandshakeType(1), SSLVer(2), Length(2), ServerKeyExchange(1), Length(3)
  ##
  ## ServerHello Done
  ## HandshakeType(1), SSLVer(2), Length(2), ServerHelloDone(1), Length(3)

  tlsv1_cipher_sup = FALSE;

  ## Check for ServerHello(4), SSL Ver(0x0002), Cipher Spec Length(3)
  ## If all the conditions specified menas, given cipher spec is supported
  ## by server
  if(ord(server_hello[0]) == 22 &amp;&amp; ord(server_hello[1]) == 3 &amp;&amp; ord(server_hello[2]) == 1 &amp;&amp;
     ord(server_hello[5]) == 2 &amp;&amp;  ord(server_hello[9]) == 3){
    tlsv1_cipher_sup = TRUE;
  }
  return(tlsv1_cipher_sup);
}

## This function check for certain bytes in the server_hello and

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="construct_ssl_req">construct_ssl_req</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>CIPHER</dt>
			
		
			<dt>SSL_VER</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function construct_ssl_req(SSL_VER, CIPHER)
{
  ssl_req = NULL;

  ## Construct SSLv2 Request with given Cipher Spec
  if(SSL_VER == &quot;sslv2&quot;)
  {
    ## SSLv2 Version Client Hello Structure
    ## 0x80, Length(1), ClientHello(1), SSLVer(2), CipherSpecLength(2)
    ## SessionIDLength(2), ChallengeLength(2),
    ## CipherSpec(CipherSpecLength)
    ## Challenge(ChallengeLength)

    ssl_req = raw_string(
                          0x80, 0x1e, 0x01, 0x00, 0x02, 0x00, 0x03, 0x00,
                          0x00, 0x00, 0x12,
                          CIPHER[0], CIPHER[1], CIPHER[2],

                          ## Challenge
                          0x00, 0x67,
                          0xc6, 0x69, 0x73, 0x51, 0xff, 0x4a, 0xec, 0x29,
                          0xcd, 0xba, 0xab, 0xf2, 0xfb, 0x00, 0x00, 0x00
                        );
  }

  ## Construct SSLv3 Request with given Cipher Spec
  else if(SSL_VER == &quot;sslv3&quot;)
  {
     ## SSLv3 Client Hello Structure
     ## HandshakeType(1), SSLVer(2), Length(2), ClientHello(1), Length(3)
     ## SSLVer(2), RandomData(32), SessionID(1),
     ## CipherSuitLength(2), CipherSuit(CipherSuitLength),
     ## CompressionMethodLength(1), CompressionMethod(CompressionMethodLength)

     ssl_req = raw_string(
                           0x16, 0x03, 0x00, 0x00, 0x2d, 0x01, 0x00, 0x00,
                           0x29, 0x03, 0x00,

                           ## Random 32 byte data
                           0xec, 0x18, 0xdb, 0x5c, 0x02, 0x1a, 0xfe, 0x43,
                           0xfb, 0xfa, 0xaa, 0x3a, 0xfb, 0x29, 0xd1, 0xe6,
                           0x05, 0x3c, 0x7c, 0x94, 0x75, 0xd8, 0xbe, 0x61,
                           0x89, 0xf9, 0x5c, 0xbb, 0xa8, 0x99, 0x0f, 0x95,

                           0x00, 0x00, 0x02,
                           CIPHER[0], CIPHER[1],
                           0x01, 0x00, 0x00, 0x00
                         );
  }

  ## Construct TLSv1 Request with given Cipher Spec
  else if(SSL_VER == &quot;tlsv1&quot;)
  {

     ## TLSv1
     ## TLSv1 Client Hello Structure
     ## HandshakeType(1), TLSVer(2), Length(2), ClientHello(1), Length(3)
     ## SSLVer(2), RandomData(32), SessionID(1),
     ## CipherSuitLength(2), CipherSuit(CipherSuitLength),
     ## CompressionMethodLength(1), CompressionMethod(CompressionMethodLength)

     ssl_req = raw_string(
                           0x16, 0x03, 0x01, 0x00, 0x2d, 0x01, 0x00, 0x00,
                           0x29, 0x03, 0x01,

                           ## Random 32 byte data
                           0xec, 0x18, 0xdb, 0x5c, 0x02, 0x1a, 0xfe, 0x43,
                           0xfb, 0xfa, 0xaa, 0x3a, 0xfb, 0x29, 0xd1, 0xe6,
                           0x05, 0x3c, 0x7c, 0x94, 0x75, 0xd8, 0xbe, 0x61,
                           0x89, 0xf9, 0x5c, 0xbb, 0xa8, 0x99, 0x0f, 0x95,

                           0x00, 0x00, 0x02,
                           CIPHER[0], CIPHER[1],
                           0x01, 0x00, 0x00, 0x00
                         );
  }

  ## Construct TLSv1_1 Request with given Cipher Spec
  else if(SSL_VER == &quot;tlsv1_1&quot;)
  {

     ## TLSv1_1
     ## TLSv1 Client Hello Structure
     ## HandshakeType(1), TLSVer(2), Length(2), ClientHello(1), Length(3)
     ## SSLVer(2), RandomData(32), SessionID(1),
     ## CipherSuitLength(2), CipherSuit(CipherSuitLength),
     ## CompressionMethodLength(1), CompressionMethod(CompressionMethodLength)

     ssl_req = raw_string(
                           0x16, 0x03, 0x01, 0x00, 0x2d, 0x01, 0x00, 0x00,
                           0x29, 0x03, 0x02,

                           ## Random 32 byte data
                           0xec, 0x18, 0xdb, 0x5c, 0x02, 0x1a, 0xfe, 0x43,
                           0xfb, 0xfa, 0xaa, 0x3a, 0xfb, 0x29, 0xd1, 0xe6,
                           0x05, 0x3c, 0x7c, 0x94, 0x75, 0xd8, 0xbe, 0x61,
                           0x89, 0xf9, 0x5c, 0xbb, 0xa8, 0x99, 0x0f, 0x95,

                           0x00, 0x00, 0x02,
                           CIPHER[0], CIPHER[1],
                           0x01, 0x00, 0x00, 0x00
                         );
  }

  ## Construct TLSv1_2 Request with given Cipher Spec
  else if(SSL_VER == &quot;tlsv1_2&quot;)
  {

     ## TLSv1_2
     ## TLSv1 Client Hello Structure
     ## HandshakeType(1), TLSVer(2), Length(2), ClientHello(1), Length(3)
     ## SSLVer(2), RandomData(32), SessionID(1),
     ## CipherSuitLength(2), CipherSuit(CipherSuitLength),
     ## CompressionMethodLength(1), CompressionMethod(CompressionMethodLength)

     ssl_req = raw_string(
                           0x16, 0x03, 0x01, 0x00, 0x2d, 0x01, 0x00, 0x00,
                           0x29, 0x03, 0x03,

                          ## Random 32 byte data
                           0xec, 0x18, 0xdb, 0x5c, 0x02, 0x1a, 0xfe, 0x43,
                           0xfb, 0xfa, 0xaa, 0x3a, 0xfb, 0x29, 0xd1, 0xe6,
                           0x05, 0x3c, 0x7c, 0x94, 0x75, 0xd8, 0xbe, 0x61,
                           0x89, 0xf9, 0x5c, 0xbb, 0xa8, 0x99, 0x0f, 0x95,

                           0x00, 0x00, 0x02,
                           CIPHER[0], CIPHER[1],
                           0x01, 0x00, 0x00, 0x00
                         );
  }

  return(ssl_req);
}

## This function sends given client hello request

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="get_ssl_server_hello">get_ssl_server_hello</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>sslPort</dt>
			
		
			<dt>ssl_req</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function get_ssl_server_hello(ssl_req, sslPort)
{
    local_var soc, sslPort;

    soc = open_ssl_socket( port:sslPort );
    if(!soc){
      return FALSE;
    }

    send(socket:soc, data:ssl_req);
    server_res = recv(socket:soc, length:16);

    close(soc);

    return (server_res);
}


## This function check for certain bytes in the server_hello and

		</pre>
		<a href="#top">top</a>
		<hr>
		
		
		
		
		

	</div><!--/span-->
	</div><!--/row-->

	<hr>

	<footer>
		<p>&copy; Tenable Network Security 2014</p>
	</footer>

  </div><!--/.fluid-container-->

  <!-- Le javascript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script type="text/javascript" src="js/jquery-1.8.2.js"></script>
  <script type="text/javascript" src="js/bootstrap.min.js"></script>
  <script type="text/javascript" src="js/shCore.js"></script>
  <script type="text/javascript" src="js/shBrushNasl.js"></script>

  <script type="text/javascript">
    SyntaxHighlighter.defaults['collapse'] = true;
    SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.all();
  </script>

  </body>
</html>
