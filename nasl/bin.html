



<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <title>nasldoc: nasl</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!-- Le styles -->
  <style type="text/css">
	body {
	padding-top: 60px;
	padding-bottom: 40px;
	}
	.sidebar-nav {
	padding: 9px 0;
	}
  </style>

  <link href="css/bootstrap.min.css" rel="stylesheet">
  <link href="css/shCore.css" rel="stylesheet" type="text/css" />
  <link href="css/shThemeDefault.css" rel="stylesheet" type="text/css" />

  <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
  <!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <!-- Fav and touch icons -->
  <link rel="shortcut icon" href="ico/favicon.ico">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="ico/apple-touch-icon-144-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="ico/apple-touch-icon-114-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="ico/apple-touch-icon-72-precomposed.png">
  <link rel="apple-touch-icon-precomposed" href="ico/apple-touch-icon-57-precomposed.png">
  </head>

  <body>

	<div class="navbar navbar-inverse navbar-fixed-top">
	  <div class="navbar-inner">
		<div class="container-fluid">
		  <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
		  </a>
		  <a class="brand" href="index.html">nasldoc</a>
		  <div class="nav-collapse collapse">
			<ul class="nav">
			  <li class="active"><a href="index.html">Home</a></li>
			</ul>
		  </div><!--/.nav-collapse -->
		</div>
	  </div>
	</div>

  <div class="container-fluid">
	<div class="row-fluid">
	<div class="span3">
	  <div class="well sidebar-nav">
	  <ul class="nav nav-list">
		
			
			
			<li class="even">
			  <a href="GSHB_BruteForce.html">GSHB_BruteForce.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="GSHB_read_file.html">GSHB_read_file.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="bad_ssh_host_keys.html">bad_ssh_host_keys.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="bad_ssh_keys.html">bad_ssh_keys.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="bin.html">bin.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="byte_func.html">byte_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="cisco_ios.html">cisco_ios.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="cpe.html">cpe.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="default_account.html">default_account.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="default_credentials.html">default_credentials.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="dump.html">dump.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="ftp_func.html">ftp_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="gb_openssl_heartbeat.html">gb_openssl_heartbeat.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="global_settings.html">global_settings.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="gvr_apps_auth_func.html">gvr_apps_auth_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="host_details.html">host_details.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="hp_printers.html">hp_printers.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="http_func.html">http_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="http_keepalive.html">http_keepalive.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="imap_func.html">imap_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="itg.html">itg.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="junos.html">junos.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="kyocera_printers.html">kyocera_printers.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="ldap.html">ldap.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="lexmark_printers.html">lexmark_printers.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="misc_func.html">misc_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="netop.html">netop.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="network_func.html">network_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="nfs_func.html">nfs_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="nmap.html">nmap.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="nntp_func.html">nntp_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="os_eol.html">os_eol.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="pingpong.html">pingpong.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="pkg-lib-bsd.html">pkg-lib-bsd.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="pkg-lib-deb.html">pkg-lib-deb.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="pkg-lib-gentoo.html">pkg-lib-gentoo.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="pkg-lib-hpux.html">pkg-lib-hpux.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="pkg-lib-macosx.html">pkg-lib-macosx.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="pkg-lib-rpm.html">pkg-lib-rpm.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="pkg-lib-slack.html">pkg-lib-slack.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="pop3_func.html">pop3_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="revisions-lib.html">revisions-lib.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="rsync_func.html">rsync_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="secpod_activex.html">secpod_activex.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="secpod_ie_supersede.html">secpod_ie_supersede.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="secpod_reg.html">secpod_reg.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="secpod_smb_func.html">secpod_smb_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="secpod_ssl_ciphers.html">secpod_ssl_ciphers.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="sharp_printers.html">sharp_printers.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="sip.html">sip.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="smb_default_credentials.html">smb_default_credentials.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="smb_nt.html">smb_nt.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="smbcl_func.html">smbcl_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="smtp_func.html">smtp_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="snmp_func.html">snmp_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="solaris.html">solaris.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="ssh_func.html">ssh_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="ssl_funcs.html">ssl_funcs.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="telnet_func.html">telnet_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="tftp.html">tftp.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="uddi.html">uddi.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="url_func.html">url_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="version_func.html">version_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="vmware_esx.html">vmware_esx.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="wmi_file.html">wmi_file.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="wmi_hardware.html">wmi_hardware.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="wmi_misc.html">wmi_misc.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="wmi_os.html">wmi_os.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="wmi_proc.html">wmi_proc.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="wmi_rsop.html">wmi_rsop.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="wmi_svc.html">wmi_svc.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="wmi_user.html">wmi_user.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="wordlist.html">wordlist.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="xerox_printers.html">xerox_printers.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="xml.html">xml.inc</a>
			</li>
		
	  </ul>
	  </div><!--/.well -->
	</div><!--/span-->
	<div class="span9">

		<a name="top"></a>
		<h1>Overview of bin.inc</h1>
		

		

		
		

		<h1>Public Variable Summary</h1>

		
		<p>Public variables are intended to be accessed by the code that imports
		this library.</p>
		

		<table class="nopad">
		  <tr class="TableHeadingColor">
			<th>Name</th>
			<th>Summary</th>
		  </tr>
		  
		  <tr>
			<td><a href="#ALIGN_DEAFULT">ALIGN_DEAFULT</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#ALIGN_LEFT">ALIGN_LEFT</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#ALIGN_PAD_BYTE">ALIGN_PAD_BYTE</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#ALIGN_RIGHT">ALIGN_RIGHT</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#NATIVE_BYTE_ORDER">NATIVE_BYTE_ORDER</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#OP_BIG_ENDIAN">OP_BIG_ENDIAN</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#OP_DEFAULT_ENDIAN">OP_DEFAULT_ENDIAN</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#OP_LITTLE_ENDIAN">OP_LITTLE_ENDIAN</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#OP_NATIVE_ENDIAN">OP_NATIVE_ENDIAN</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#OP_NETWORK_ENDIAN">OP_NETWORK_ENDIAN</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#OP_PAD_BYTE">OP_PAD_BYTE</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#OP_STRING">OP_STRING</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#OP_STRING_HEX">OP_STRING_HEX</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#OP_STRING_NULL">OP_STRING_NULL</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#OP_UINT_16">OP_UINT_16</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#OP_UINT_32">OP_UINT_32</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#OP_UINT_64">OP_UINT_64</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#OP_UINT_8">OP_UINT_8</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#VAL_PAD_BYTE">VAL_PAD_BYTE</a></td>
			<td></td>
		  </tr>
		  
		</table>
		
		
		
		

		
		
		<h1>Public Function Summary</h1>

		
		<p>Public functions are intended to be called by the code that imports
		this library.</p>
		

		<table class="nopad">
		  <tr class="TableHeadingColor">
			<th>Name</th>
			<th>Summary</th>
		  </tr>
		  
		  <tr>
			<td><a href="#align">align</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#bin_pack">bin_pack</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#bin_unpack">bin_unpack</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#dump_arr">dump_arr</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#pack_pad_byte">pack_pad_byte</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#pack_string">pack_string</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#pack_string_hex">pack_string_hex</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#pack_string_null">pack_string_null</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#pack_uint_16">pack_uint_16</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#pack_uint_32">pack_uint_32</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#pack_uint_64">pack_uint_64</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#pack_uint_8">pack_uint_8</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#populate">populate</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#unpack_pad_byte">unpack_pad_byte</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#unpack_string">unpack_string</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#unpack_string_hex">unpack_string_hex</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#unpack_string_null">unpack_string_null</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#unpack_uint_16">unpack_uint_16</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#unpack_uint_32">unpack_uint_32</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#unpack_uint_64">unpack_uint_64</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#unpack_uint_8">unpack_uint_8</a></td>
			<td></td>
		  </tr>
		  
		</table>
		
		
		
		

		
		
		<h1>Public Variable Details</h1>
		
		<h2 id="ALIGN_DEAFULT">ALIGN_DEAFULT</h2>
		

		

		<a href="#top">top</a>
		<hr>
		
		<h2 id="ALIGN_LEFT">ALIGN_LEFT</h2>
		

		

		<a href="#top">top</a>
		<hr>
		
		<h2 id="ALIGN_PAD_BYTE">ALIGN_PAD_BYTE</h2>
		

		

		<a href="#top">top</a>
		<hr>
		
		<h2 id="ALIGN_RIGHT">ALIGN_RIGHT</h2>
		

		

		<a href="#top">top</a>
		<hr>
		
		<h2 id="NATIVE_BYTE_ORDER">NATIVE_BYTE_ORDER</h2>
		

		

		<a href="#top">top</a>
		<hr>
		
		<h2 id="OP_BIG_ENDIAN">OP_BIG_ENDIAN</h2>
		

		

		<a href="#top">top</a>
		<hr>
		
		<h2 id="OP_DEFAULT_ENDIAN">OP_DEFAULT_ENDIAN</h2>
		

		

		<a href="#top">top</a>
		<hr>
		
		<h2 id="OP_LITTLE_ENDIAN">OP_LITTLE_ENDIAN</h2>
		

		

		<a href="#top">top</a>
		<hr>
		
		<h2 id="OP_NATIVE_ENDIAN">OP_NATIVE_ENDIAN</h2>
		

		

		<a href="#top">top</a>
		<hr>
		
		<h2 id="OP_NETWORK_ENDIAN">OP_NETWORK_ENDIAN</h2>
		

		

		<a href="#top">top</a>
		<hr>
		
		<h2 id="OP_PAD_BYTE">OP_PAD_BYTE</h2>
		

		

		<a href="#top">top</a>
		<hr>
		
		<h2 id="OP_STRING">OP_STRING</h2>
		

		

		<a href="#top">top</a>
		<hr>
		
		<h2 id="OP_STRING_HEX">OP_STRING_HEX</h2>
		

		

		<a href="#top">top</a>
		<hr>
		
		<h2 id="OP_STRING_NULL">OP_STRING_NULL</h2>
		

		

		<a href="#top">top</a>
		<hr>
		
		<h2 id="OP_UINT_16">OP_UINT_16</h2>
		

		

		<a href="#top">top</a>
		<hr>
		
		<h2 id="OP_UINT_32">OP_UINT_32</h2>
		

		

		<a href="#top">top</a>
		<hr>
		
		<h2 id="OP_UINT_64">OP_UINT_64</h2>
		

		

		<a href="#top">top</a>
		<hr>
		
		<h2 id="OP_UINT_8">OP_UINT_8</h2>
		

		

		<a href="#top">top</a>
		<hr>
		
		<h2 id="VAL_PAD_BYTE">VAL_PAD_BYTE</h2>
		

		

		<a href="#top">top</a>
		<hr>
		
		
		
		
		

		
		
		<h1>Public Function Details</h1>
		
		<h2 id="align">align</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>al</dt>
			
		
			<dt>blob</dt>
			
		
			<dt>boundary</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function align(blob, boundary, al){
  local_var padding_size, padding, i;
  if(isnull(al))
    al = ALIGN_DEFAULT;
  padding_size = boundary - (strlen(blob) % boundary);
  padding = &#39;&#39;;
  for(i = 0; i &lt; padding_size; i++)
    padding += ALIGN_PAD_BYTE;
  if(al == ALIGN_LEFT){
    return blob + padding;
  }
  else{
    return padding + blob;
  }
}

#  @brief Make a string indexed array(dictionary) from an regular array.

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="bin_pack">bin_pack</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>format</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function bin_pack(format){
  local_var args;
  local_var format_len, endianess, iOp;
  local_var result, iArg;

  args = _FCT_ANON_ARGS;
  format_len = strlen(format);
  if(format[0] == OP_LITTLE_ENDIAN || format[0] == OP_BIG_ENDIAN || format[0] == OP_NATIVE_ENDIAN || format[0] == OP_NETWORK_ENDIAN){
    endianess = format[0];
    iOp = 1;
  }
  else{
    endianess = OP_DEFAULT_ENDIAN;
    iOp = 0;
  }
  #Process format string
  result = &#39;&#39;;
  iArg = 0;
  for(iOp = iOp; iOp &lt; format_len; iOp++){
    if(format[iOp] == OP_UINT_8){
      result += pack_uint_8(data: args[iArg]);
      iArg++;
    }
    else if(format[iOp] == OP_UINT_16){
      result += pack_uint_16(data: args[iArg], endianess: endianess);
      iArg++;
    }
    else if(format[iOp] == OP_UINT_32){
      result += pack_uint_32(data: args[iArg], endianess: endianess);
      iArg++;
    }
    else if(format[iOp] == OP_UINT_64){
      result += pack_uint_64(data: args[iArg], endianess: endianess);
      iArg++;
    }
    else if(format[iOp] == OP_PAD_BYTE){
      result += pack_pad_byte();
    }
    else if(format[iOp] == OP_STRING){
      result += pack_string(data: args[iArg]);
      iArg++;
    }
    else if(format[iOp] == OP_STRING_NULL){
      result += pack_string_null(data: args[iArg]);
      iArg++;
    }
    else if(format[iOp] == OP_STRING_HEX){
      result += pack_string_hex(data: args[iArg]);
      iArg++;
    }
    else if(format[iOp] == OP_LITTLE_ENDIAN || format[iOp] == OP_BIG_ENDIAN || format[iOp] == OP_NATIVE_ENDIAN || format[iOp] == OP_NETWORK_ENDIAN){
      endianess = format[iOp];
      continue;
    }
  }
  return result;
}

#  @brief Blob is unpacked according to the unpacking format.

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="bin_unpack">bin_unpack</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>blob</dt>
			
		
			<dt>format</dt>
			
		
			<dt>pos</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function bin_unpack(format, blob, pos){
  local_var lens, pos_old;
  local_var format_len, endianess, iOp;
  local_var result, iLen, iField, unpack_struct, data;
  if(isnull(pos))
    pos = 0;
  lens = _FCT_ANON_ARGS;
  pos_old = pos;
  format_len = strlen(format);
  if(format[0] == OP_LITTLE_ENDIAN || format[0] == OP_BIG_ENDIAN || format[0] == OP_NATIVE_ENDIAN || format[0] == OP_NETWORK_ENDIAN){
    endianess = format[0];
    iOp = 1;
  }
  else{
    endianess = OP_DEFAULT_ENDIAN;
    iOp = 0;
  }
  #Process format string
  iField = 0;
  iLen = 0;
  for(iOp = iOp; iOp &lt; format_len; iOp++){
    if(format[iOp] == OP_UINT_8){
      unpack_struct = unpack_uint_8(blob: blob, pos: pos);
      data[iField] = unpack_struct[&#39;data&#39;];
      pos += strlen(unpack_struct[&#39;blob&#39;]);
      iField++;
    }
    else if(format[iOp] == OP_UINT_16){
      unpack_struct = unpack_uint_16(blob: blob, pos: pos, endianess: endianess);
      data[iField] = unpack_struct[&#39;data&#39;];
      pos += strlen(unpack_struct[&#39;blob&#39;]);
      iField++;
    }
    else if(format[iOp] == OP_UINT_32){
      unpack_struct = unpack_uint_32(blob: blob, pos: pos, endianess: endianess);
      data[iField] = unpack_struct[&#39;data&#39;];
      pos += strlen(unpack_struct[&#39;blob&#39;]);
      iField++;
    }
    else if(format[iOp] == OP_UINT_64){
      unpack_struct = unpack_uint_64(blob: blob, pos: pos, endianess: endianess);
      data[iField] = unpack_struct[&#39;data&#39;];
      pos += strlen(unpack_struct[&#39;blob&#39;]);
      iField++;
    }
    else if(format[iOp] == OP_PAD_BYTE){
      pos += unpack_pad_byte(blob: blob, pos: pos); #drop pad bytes...not interested in pad bytes. Kill all them padders, muahaaa!
    }
    else if(format[iOp] == OP_STRING){
      unpack_struct = unpack_string(blob: blob, pos: pos, len: lens[iLen]);
      data[iField] = unpack_struct[&#39;data&#39;];
      pos += strlen(unpack_struct[&#39;blob&#39;]);
      iField++;
      iLen++;
    }
    else if(format[iOp] == OP_STRING_NULL){
      unpack_struct = unpack_string_null(blob: blob, pos: pos);
      data[iField] = unpack_struct[&#39;data&#39;];
      pos += strlen(unpack_struct[&#39;blob&#39;]);
      iField++;
    }
    else if(format[iOp] == OP_STRING_HEX){
      unpack_struct = unpack_string_hex(blob: blob, pos: pos, len: lens[iLen]);
      data[iField] = unpack_struct[&#39;data&#39;];
      pos += strlen(unpack_struct[&#39;blob&#39;]);
      iField++;
      iLen++;
    }
    else if(format[iOp] == OP_LITTLE_ENDIAN || format[iOp] == OP_BIG_ENDIAN || format[iOp] == OP_NATIVE_ENDIAN || format[iOp] == OP_NETWORK_ENDIAN){
      endianess = format[iOp];
      continue;
    }
  }
  result[&#39;blob&#39;] = substr(blob, pos_old, pos - 1);
  result[&#39;data&#39;] = data;
  return result;
}

#  @brief Aligns a blob to a boundary.

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="dump_arr">dump_arr</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>arr</dt>
			
		
			<dt>title</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function dump_arr(arr, title){
  display(&#39;---[ &#39; + title + &#39; ]---\n&#39; );
  local_var k, e, key, elem, keyz, elemz;
  k = 0;
  foreach key (keys(arr)) keyz[k++] = key;
  for(e = 0; e &lt; k; e++) display(keyz[e] + &#39;:&#39; + arr[keyz[e]] + &#39;\n&#39;);
  display(&#39;--------------\n&#39; );
}
###########################

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="pack_pad_byte">pack_pad_byte</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function pack_pad_byte(){
  return VAL_PAD_BYTE;
}

#  @brief Unpack a 1B blob.

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="pack_string">pack_string</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>data</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function pack_string(data){
  return data;
}

#  @brief Unpack a blob of &#39;len&#39; length into a string object.

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="pack_string_hex">pack_string_hex</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>data</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function pack_string_hex(data){
  local_var hex, hex_len, result;
  local_var val;
  #Prep data
  hex = tolower(data);
  hex = ereg_replace(string: hex, pattern: &quot;0x|[&#39; &#39;&#39;\r&#39;&#39;\n&#39;&#39;\t&#39;]&quot;, replace: &#39;&#39;);
  hex_len = strlen(hex);
  #Parse
  result = &#39;&#39;;
  for(i = 0; i &lt; hex_len; i = i+2){
    if(ord(hex[i]) &gt;= ord(&#39;a&#39;) &amp;&amp; ord(hex[i]) &lt;= ord(&#39;f&#39;)){
      val = 16*(ord(hex[i]) - ord(&#39;a&#39;) + 10);
    }
    else if(ord(hex[i]) &gt;= ord(&#39;0&#39;) &amp;&amp; ord(hex[i]) &lt;= ord(&#39;9&#39;)){
      val = 16*(ord(hex[i]) - ord(&#39;0&#39;));
    }
    else continue;

    if(ord(hex[i+1]) &gt;= ord(&#39;a&#39;) &amp;&amp; ord(hex[i+1]) &lt;= ord(&#39;f&#39;)){
      val += (ord(hex[i+1]) - ord(&#39;a&#39;) + 10);
    }
    else if(ord(hex[i+1]) &gt;= ord(&#39;0&#39;) &amp;&amp; ord(hex[i+1]) &lt;= ord(&#39;9&#39;)){
      val += ord(hex[i+1]) - ord(&#39;0&#39;);;
    }
    else continue;
    result += raw_string(val);
  }
  return result;
}

#  @brief Unpack a blob of &#39;len&#39; length into a hex string.

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="pack_string_null">pack_string_null</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>data</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function pack_string_null(data){
  return data + raw_string(0x00);
}

#  @brief Unpack a null terminated blob.

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="pack_uint_16">pack_uint_16</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>data</dt>
			
		
			<dt>endianess</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function pack_uint_16(data, endianess){
  local_var uint_16, uint_16_lo, uint_16_hi;
  local_var result;
  uint_16 = data % (256*256); #modulo normalization - if data is bigger than short
  uint_16_lo = uint_16 % 256;
  uint_16_hi = uint_16 / 256;

  if(endianess == OP_NATIVE_ENDIAN){
    endianess = NATIVE_BYTE_ORDER; #retrieved from INIT
  }

  if(endianess == OP_LITTLE_ENDIAN){
    result = raw_string(uint_16_lo, uint_16_hi);
  }
  else if(endianess == OP_BIG_ENDIAN || endianess == OP_NETWORK_ENDIAN){
    result = raw_string(uint_16_hi, uint_16_lo);
  }
  return result;
}

#  @brief Unpack a 2B blob into an unsigned short object.

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="pack_uint_32">pack_uint_32</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>data</dt>
			
		
			<dt>endianess</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function pack_uint_32(data, endianess){
  local_var uint_32, uint_32_lo, uint_32_hi, uint_32_lo_lo, uint_32_lo_hi, uint_32_hi_lo, uint_32_hi_hi;
  local_var result;
  uint_32 = data;
  uint_32_lo = uint_32 % (256*256);
  uint_32_hi = uint_32 / (256*256);
  uint_32_lo_lo = uint_32_lo % 256;
  uint_32_lo_hi = uint_32_lo / 256;
  uint_32_hi_lo = uint_32_hi % 256;
  uint_32_hi_hi = uint_32_hi / 256;

  if(endianess == OP_NATIVE_ENDIAN){
    endianess = NATIVE_BYTE_ORDER; #retrieved from INIT
  }

  if(endianess == OP_LITTLE_ENDIAN){
    result = raw_string(uint_32_lo_lo, uint_32_lo_hi, uint_32_hi_lo, uint_32_hi_hi);
  }
  else if(endianess == OP_BIG_ENDIAN || endianess == OP_NETWORK_ENDIAN){
    result = raw_string(uint_32_hi_hi, uint_32_hi_lo, uint_32_lo_hi, uint_32_lo_lo);
  }
  return result;
}


#  @brief Unpack a 4B blob into an unsigned long object.

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="pack_uint_64">pack_uint_64</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>data</dt>
			
		
			<dt>endianess</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function pack_uint_64(data, endianess){
  local_var result;
  if(endianess == OP_NATIVE_ENDIAN){
    endianess = NATIVE_BYTE_ORDER; #retrieved from INIT
  }

  if(endianess == OP_LITTLE_ENDIAN){
    result = pack_uint_32(data: data, endianess: endianess) + raw_string(0x00, 0x00, 0x00, 0x00);
  }
  else if(endianess == OP_BIG_ENDIAN || endianess == OP_NETWORK_ENDIAN){
    result = raw_string(0x00, 0x00, 0x00, 0x00) + pack_uint_32(data: data, endianess: endianess);
  }
  return result;
}


#  @brief Unpack a 8B blob into an unsigned long long object.

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="pack_uint_8">pack_uint_8</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>data</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function pack_uint_8(data){
  return raw_string(data % 256);
}

#  @brief Unpack a 1B blob into an unsigned char object.

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="populate">populate</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>arr</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function populate(arr){
  local_var result;
  for(i = 0; i &lt; max_index(arr); i++){
    result[_FCT_ANON_ARGS[i]] = arr[i];
  }
  return result;
}
#  @brief Display an array

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="unpack_pad_byte">unpack_pad_byte</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>blob</dt>
			
		
			<dt>pos</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function unpack_pad_byte(blob, pos){
  return 1;
}

#  @brief Pack a string into a strlen(string)B blob.

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="unpack_string">unpack_string</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>blob</dt>
			
		
			<dt>len</dt>
			
		
			<dt>pos</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function unpack_string(blob, pos, len){
  local_var result;
  if(isnull(len))
    len = strlen(blob) - pos;
  result[&#39;data&#39;] = substr(blob, pos, pos + len - 1);
  result[&#39;blob&#39;] = result[&#39;data&#39;];
  return result;
}

#  @brief Pack a string into a strlen(string)B+1B NULL terminated blob.

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="unpack_string_hex">unpack_string_hex</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>blob</dt>
			
		
			<dt>len</dt>
			
		
			<dt>pos</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function unpack_string_hex(blob, pos, len){
  local_var hexstr;
  local_var result;
  if(isnull(len))
    len = strlen(blob) - pos;
  hexstr = &#39;&#39;;
  for(i = 0; i &lt; len; i++){
    hexstr += hex(ord(blob[pos + i])) + &#39;,&#39;;
  }
  result[&#39;data&#39;] = hexstr;
  result[&#39;blob&#39;] = substr(blob, pos, pos + len - 1);
  return result;
}



		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="unpack_string_null">unpack_string_null</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>blob</dt>
			
		
			<dt>pos</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function unpack_string_null(blob, pos){
  local_var result, i, blob_len;
  result[&#39;data&#39;] = &#39;&#39;;
  result[&#39;blob&#39;] = &#39;&#39;;
  blob_len = strlen(blob);
  for(i = pos; i &lt; blob_len; i++){
    result[&#39;blob&#39;] += blob[i];
    if(blob[i] == raw_string(0x00)) break;
    result[&#39;data&#39;] += blob[i];
  }
  return result;
}

#  @brief Pack a hex ascii string into a raw string blob.

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="unpack_uint_16">unpack_uint_16</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>blob</dt>
			
		
			<dt>endianess</dt>
			
		
			<dt>pos</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function unpack_uint_16(blob, pos, endianess){
  local_var result;
  if(isnull(pos))
    pos = 0;
  if(endianess == OP_NATIVE_ENDIAN){
    endianess = NATIVE_BYTE_ORDER; #retrieved from INIT
  }
  if(endianess == OP_LITTLE_ENDIAN){
    result[&#39;data&#39;] = ord(blob[pos]) + ord(blob[pos+1])*256;
  }
  else if(endianess == OP_BIG_ENDIAN || endianess == OP_NETWORK_ENDIAN){
    result[&#39;data&#39;] = ord(blob[pos])*256 + ord(blob[pos+1]);
  }
  result[&#39;blob&#39;] = substr(blob, pos, pos + 1);
  return result;
}

#  @brief Pack an unsigned long into a 4B blob.

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="unpack_uint_32">unpack_uint_32</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>blob</dt>
			
		
			<dt>endianess</dt>
			
		
			<dt>pos</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function unpack_uint_32(blob, pos, endianess){
  local_var result;
  if(isnull(pos))
    pos = 0;
  if(endianess == OP_NATIVE_ENDIAN){
    endianess = NATIVE_BYTE_ORDER; #retrieved from INIT
  }
  if(endianess == OP_LITTLE_ENDIAN){
    result[&#39;data&#39;] = ord(blob[pos]) + ord(blob[pos+1])*256+ ord(blob[pos+2])*256*256 + ord(blob[pos+3])*256*256*256;
  }
  else if(endianess == OP_BIG_ENDIAN || endianess == OP_NETWORK_ENDIAN){
    result[&#39;data&#39;] = ord(blob[pos+3]) + ord(blob[pos+2])*256+ ord(blob[pos+1])*256*256 + ord(blob[pos])*256*256*256;
  }
  result[&#39;blob&#39;] = substr(blob, pos, pos + 3);
  return result;
}

#  @brief Pack an unsigned long long into a 8B blob.

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="unpack_uint_64">unpack_uint_64</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>blob</dt>
			
		
			<dt>endianess</dt>
			
		
			<dt>pos</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function unpack_uint_64(blob, pos, endianess){
  local_var unpack_struct, result;
  if(endianess == OP_NATIVE_ENDIAN){
    endianess = NATIVE_BYTE_ORDER; #retrieved from INIT
  }
  if(endianess == OP_LITTLE_ENDIAN){
    unpack_struct = unpack_uint_32(blob: blob, endianess: endianess);
    result[&#39;data&#39;] = unpack_struct[&#39;data&#39;];
  }
  else if(endianess == OP_BIG_ENDIAN || endianess == OP_NETWORK_ENDIAN){
    unpack_struct = unpack_uint_32(blob: blob, pos: pos + 4, endianess: endianess);
    result[&#39;data&#39;] = unpack_struct[&#39;data&#39;];
  }
  result[&#39;blob&#39;] = substr(blob, pos, pos + 7);
  return result;
}

#  @brief Pack VAL_PAD_BYTE into a 1B blob.

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="unpack_uint_8">unpack_uint_8</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>blob</dt>
			
		
			<dt>pos</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function unpack_uint_8(blob, pos){
  local_var result;
  result[&#39;data&#39;] = ord(blob[pos]);
  result[&#39;blob&#39;] = substr(blob, pos, pos);
  return result;
}

#  @brief Pack an unsigned short into a 2B blob.

		</pre>
		<a href="#top">top</a>
		<hr>
		
		
		
		
		

	</div><!--/span-->
	</div><!--/row-->

	<hr>

	<footer>
		<p>&copy; Tenable Network Security 2014</p>
	</footer>

  </div><!--/.fluid-container-->

  <!-- Le javascript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script type="text/javascript" src="js/jquery-1.8.2.js"></script>
  <script type="text/javascript" src="js/bootstrap.min.js"></script>
  <script type="text/javascript" src="js/shCore.js"></script>
  <script type="text/javascript" src="js/shBrushNasl.js"></script>

  <script type="text/javascript">
    SyntaxHighlighter.defaults['collapse'] = true;
    SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.all();
  </script>

  </body>
</html>
