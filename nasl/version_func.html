



<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <title>nasldoc: nasl</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!-- Le styles -->
  <style type="text/css">
	body {
	padding-top: 60px;
	padding-bottom: 40px;
	}
	.sidebar-nav {
	padding: 9px 0;
	}
  </style>

  <link href="css/bootstrap.min.css" rel="stylesheet">
  <link href="css/shCore.css" rel="stylesheet" type="text/css" />
  <link href="css/shThemeDefault.css" rel="stylesheet" type="text/css" />

  <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
  <!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <!-- Fav and touch icons -->
  <link rel="shortcut icon" href="ico/favicon.ico">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="ico/apple-touch-icon-144-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="ico/apple-touch-icon-114-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="ico/apple-touch-icon-72-precomposed.png">
  <link rel="apple-touch-icon-precomposed" href="ico/apple-touch-icon-57-precomposed.png">
  </head>

  <body>

	<div class="navbar navbar-inverse navbar-fixed-top">
	  <div class="navbar-inner">
		<div class="container-fluid">
		  <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
		  </a>
		  <a class="brand" href="index.html">nasldoc</a>
		  <div class="nav-collapse collapse">
			<ul class="nav">
			  <li class="active"><a href="index.html">Home</a></li>
			</ul>
		  </div><!--/.nav-collapse -->
		</div>
	  </div>
	</div>

  <div class="container-fluid">
	<div class="row-fluid">
	<div class="span3">
	  <div class="well sidebar-nav">
	  <ul class="nav nav-list">
		
			
			
			<li class="even">
			  <a href="GSHB_BruteForce.html">GSHB_BruteForce.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="GSHB_read_file.html">GSHB_read_file.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="bad_ssh_host_keys.html">bad_ssh_host_keys.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="bad_ssh_keys.html">bad_ssh_keys.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="bin.html">bin.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="byte_func.html">byte_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="cisco_ios.html">cisco_ios.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="cpe.html">cpe.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="default_account.html">default_account.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="default_credentials.html">default_credentials.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="dump.html">dump.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="ftp_func.html">ftp_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="gb_openssl_heartbeat.html">gb_openssl_heartbeat.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="global_settings.html">global_settings.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="gvr_apps_auth_func.html">gvr_apps_auth_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="host_details.html">host_details.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="hp_printers.html">hp_printers.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="http_func.html">http_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="http_keepalive.html">http_keepalive.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="imap_func.html">imap_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="itg.html">itg.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="junos.html">junos.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="kyocera_printers.html">kyocera_printers.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="ldap.html">ldap.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="lexmark_printers.html">lexmark_printers.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="misc_func.html">misc_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="netop.html">netop.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="network_func.html">network_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="nfs_func.html">nfs_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="nmap.html">nmap.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="nntp_func.html">nntp_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="os_eol.html">os_eol.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="pingpong.html">pingpong.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="pkg-lib-bsd.html">pkg-lib-bsd.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="pkg-lib-deb.html">pkg-lib-deb.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="pkg-lib-gentoo.html">pkg-lib-gentoo.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="pkg-lib-hpux.html">pkg-lib-hpux.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="pkg-lib-macosx.html">pkg-lib-macosx.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="pkg-lib-rpm.html">pkg-lib-rpm.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="pkg-lib-slack.html">pkg-lib-slack.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="pop3_func.html">pop3_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="revisions-lib.html">revisions-lib.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="rsync_func.html">rsync_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="secpod_activex.html">secpod_activex.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="secpod_ie_supersede.html">secpod_ie_supersede.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="secpod_reg.html">secpod_reg.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="secpod_smb_func.html">secpod_smb_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="secpod_ssl_ciphers.html">secpod_ssl_ciphers.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="sharp_printers.html">sharp_printers.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="sip.html">sip.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="smb_default_credentials.html">smb_default_credentials.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="smb_nt.html">smb_nt.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="smbcl_func.html">smbcl_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="smtp_func.html">smtp_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="snmp_func.html">snmp_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="solaris.html">solaris.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="ssh_func.html">ssh_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="ssl_funcs.html">ssl_funcs.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="telnet_func.html">telnet_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="tftp.html">tftp.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="uddi.html">uddi.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="url_func.html">url_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="version_func.html">version_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="vmware_esx.html">vmware_esx.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="wmi_file.html">wmi_file.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="wmi_hardware.html">wmi_hardware.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="wmi_misc.html">wmi_misc.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="wmi_os.html">wmi_os.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="wmi_proc.html">wmi_proc.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="wmi_rsop.html">wmi_rsop.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="wmi_svc.html">wmi_svc.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="wmi_user.html">wmi_user.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="wordlist.html">wordlist.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="xerox_printers.html">xerox_printers.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="xml.html">xml.inc</a>
			</li>
		
	  </ul>
	  </div><!--/.well -->
	</div><!--/span-->
	<div class="span9">

		<a name="top"></a>
		<h1>Overview of version_func.inc</h1>
		

		

		
		
		
		
		

		
		
		<h1>Public Function Summary</h1>

		
		<p>Public functions are intended to be called by the code that imports
		this library.</p>
		

		<table class="nopad">
		  <tr class="TableHeadingColor">
			<th>Name</th>
			<th>Summary</th>
		  </tr>
		  
		  <tr>
			<td><a href="#check_locate">check_locate</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#fetch_file_version">fetch_file_version</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#find_bin">find_bin</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#find_file">find_file</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#get_bin_version">get_bin_version</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#get_dir_from_kb">get_dir_from_kb</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#get_samba_version">get_samba_version</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#get_string_version">get_string_version</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#get_version_from_kb">get_version_from_kb</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#report_fixed_ver">report_fixed_ver</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#version_in_range">version_in_range</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#version_is_equal">version_is_equal</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#version_is_greater">version_is_greater</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#version_is_greater_equal">version_is_greater_equal</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#version_is_less">version_is_less</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#version_is_less_equal">version_is_less_equal</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#version_test">version_test</a></td>
			<td></td>
		  </tr>
		  
		</table>
		
		
		
		

		
		
		
		
		

		
		
		<h1>Public Function Details</h1>
		
		<h2 id="check_locate">check_locate</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>sock</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function check_locate(sock) {

    local_var locate_tested, r;

    if( get_kb_item( &quot;no_linux_shell&quot; ) ) return;
    if( get_kb_item(&quot;lsc/locate/broken&quot;) ) return FALSE;

    if( ! get_kb_item(&quot;lsc/locate/tested&quot;) ) {

        r = ssh_cmd(socket:sock, cmd:&quot;locate -S&quot;, timeout:60);

        if( (&quot;Database /&quot;     &gt;!&lt; r       ||
             (  &quot;bytes&quot;       &gt;!&lt; r       &amp;&amp;
                &quot;Compression&quot; &gt;!&lt; r       &amp;&amp;
                &quot;Filenames&quot;   &gt;!&lt; r       &amp;&amp;
                &quot;file names&quot;  &gt;!&lt; r ) )   ||
              &quot;command not found&quot; &gt;&lt; r    ||
              &quot;locate:&quot;       &gt;&lt; r
              ) {

          set_kb_item(name: &quot;lsc/locate/broken&quot;, value: TRUE);
          set_kb_item(name: &quot;lsc/locate/tested&quot;, value: TRUE);
          return FALSE;

        }

        set_kb_item(name: &quot;lsc/locate/tested&quot;, value: TRUE);
    }

    return TRUE;
}

## This function will return the version of the given file

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="fetch_file_version">fetch_file_version</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>file_name</dt>
			
		
			<dt>sysPath</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function fetch_file_version(sysPath, file_name) {
  share = ereg_replace(pattern:&quot;([A-Za-z]):.*&quot;, replace:&quot;\1$&quot;, string:sysPath);
  file =  ereg_replace(pattern:&quot;[A-Za-z]:(.*)&quot;, replace:&quot;\1&quot;,
                       string:sysPath + &quot;\&quot; + file_name);

  sysVer = GetVer(file:file, share:share);
  if(!sysVer || isnull(sysVer) || sysVer == &quot;&quot; || sysVer == 0 || sysVer == &#39;0&#39;) {
    return(FALSE);
  }

  return(sysVer);
}

function report_fixed_ver( installed_version, installed_build, installed_patch,

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="find_bin">find_bin</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>prog_name</dt>
			
		
			<dt>sock</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function find_bin(prog_name, sock) {

  local_var r, whe, whi, cl;

  whe = &quot;&quot;;
  whi = &quot;&quot;;

  if( get_kb_item( &quot;no_linux_shell&quot; ) ) return;

  if(! sock) {
    sock = ssh_login_or_reuse_connection();
  }
  if(sock) {

    cl = check_locate(sock:sock);

    if ( cl ) {
        r = split(ssh_cmd(socket:sock, cmd:&quot;locate -ei *bin/&quot;+prog_name, timeout:60));
    } else {
        r = NULL;
    }

  } else {
     r = NULL;
  }

  if( &quot;bin/&quot;+prog_name &gt;!&lt; r ) {
    if(sock) {
        whe = ssh_cmd(socket:sock, cmd:&quot;whereis -b &quot;+prog_name, timeout:60);
        if( &quot;bin/&quot;+prog_name &gt;&lt; whe ) {
           r = split(substr(whe - (prog_name + &quot;:&quot;), 1), sep:&quot; &quot;);
        } else {
           r = NULL;
        }
     }
  }

  if(isnull(r) ) {
    if(sock) {
        whi = ssh_cmd(socket:sock, cmd:&quot;which -a &quot;+prog_name, timeout:60);
        if((&quot;which: no &quot;+prog_name) &gt;!&lt; whi) {
           r = split(whi);
        } else {
           r = NULL;
        }
    }
  }

  return (r);

}

function find_file(file_name, file_path, useregex, regexpar, sock ) {

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="find_file">find_file</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>file_name</dt>
			
		
			<dt>file_path</dt>
			
		
			<dt>regexpar</dt>
			
		
			<dt>sock</dt>
			
		
			<dt>useregex</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function find_file(file_name, file_path, useregex, regexpar, sock ) {

  local_var r, f, fname, lparam, cl;

  if( get_kb_item( &quot;no_linux_shell&quot; ) ) return;

  r = NULL;

  if( useregex ) {
    lparam = &quot;-eir&quot;;
  } else {
    lparam = &quot;-ei&quot;;
  }

  use_find = get_kb_item(&quot;Enable/find&quot;);
  descend_directories = get_kb_item(&quot;Descend/OFS&quot;);

  if(isnull(use_find))use_find=&quot;yes&quot;;
  if(isnull(descend_directories))descend_directories=&quot;yes&quot;;

  fname = ereg_replace(pattern:&quot;\*.+&quot;, string:file_name, replace:&quot;&quot;);

  if(! sock) {
    sock = ssh_login_or_reuse_connection();
  }
  if(sock) {

    cl = check_locate(sock:sock);

    if ( cl ) {
        r = split(ssh_cmd(socket:sock, cmd:&quot;locate &quot;+lparam+&quot; &quot;+raw_string(0x22)+file_path+file_name+regexpar+raw_string(0x22), timeout:60));
    } else {
        r = NULL;
    }

    if(fname &gt;!&lt; r &amp;&amp; (&quot;yes&quot; &gt;&lt; use_find) ) {
      if(!isnull(file_path) ) {

        cmd =  &quot;find &quot;+raw_string(0x22)+file_path+raw_string(0x22);

        if(&quot;no&quot; &gt;&lt; descend_directories) {
          cmd += &quot; -xdev&quot;;
        }

        cmd += &quot; -maxdepth 7 -mindepth 1&quot;;
        cmd += &#39; \\( -path &quot;*/proc&quot; -o -path &quot;/dev&quot; -o -path &quot;/sys&quot; -o -path &quot;/media&quot; -o -path &quot;/tmp&quot; -o -path &quot;/var&quot; \\) -prune -o &#39;;
        cmd += &quot; -name &quot;+raw_string(0x22);
        cmd += file_name+raw_string(0x22)+&quot; -a \( -type f -o -type l \) -print 2&gt;/dev/null&quot;;

        f = split(ssh_cmd(socket:sock, cmd: cmd, timeout:60));

      }
    }
  }

  if( fname &gt;!&lt; r ) {
    if( fname &gt;&lt; f &amp;&amp; &quot;No such file or directory&quot; &gt;!&lt; f) {
      r = f;
    } else {
      r = NULL;
    }
  }
  return (r);
}

function get_bin_version(full_prog_name, version_argv, ver_pattern, sock) {

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="get_bin_version">get_bin_version</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>full_prog_name</dt>
			
		
			<dt>sock</dt>
			
		
			<dt>ver_pattern</dt>
			
		
			<dt>version_argv</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function get_bin_version(full_prog_name, version_argv, ver_pattern, sock) {
  local_var loc_version, r, report;

  if( get_kb_item( &quot;no_linux_shell&quot; ) ) return;

  full_prog_name = chomp(full_prog_name);
  version_argv = chomp(version_argv);

  if(! sock) {
    sock = ssh_login_or_reuse_connection();
  }
  if(sock) {
    r = ssh_cmd(socket:sock, cmd:full_prog_name +&quot; &quot;+version_argv, timeout:60);
  }
  loc_version = eregmatch(pattern:ver_pattern, string:r);
  if(loc_version != NULL) loc_version[max_index(loc_version)] = r;
  return (loc_version);
}

function get_string_version(text, ver_pattern) {

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="get_dir_from_kb">get_dir_from_kb</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>app</dt>
			
		
			<dt>port</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function get_dir_from_kb(port,app) {

  local_var port, app, dir, version, matches;

  if( ! port ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#port#-#get_dir_from_kb&quot; );
  if( ! app ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#app#-#get_dir_from_kb&quot; );

  if(isnull(port) || isnull(app))return FALSE;

  if(!version = get_kb_item(string(&quot;www/&quot;, port, &quot;/&quot;,app)))return FALSE;
  if(!matches = eregmatch(string:version, pattern:&quot;^(.+) under (/.*)$&quot;))return FALSE;

  dir = matches[2];

  if(isnull(dir)) return FALSE;

  return string(dir);

}

function get_samba_version() { # add  &quot;script_dependencies(&quot;smb_nativelanman.nasl&quot;);&quot; to your NVT to make this function work

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="get_samba_version">get_samba_version</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function get_samba_version() { # add  &quot;script_dependencies(&quot;smb_nativelanman.nasl&quot;);&quot; to your NVT to make this function work


  if(!lanman = get_kb_item(&quot;SMB/NativeLanManager&quot;))return FALSE;
  if(&quot;Samba&quot; &gt;!&lt; lanman)return FALSE;

  if(!version = eregmatch(pattern:&quot;Samba ([0-9.]+)&quot;, string: lanman))return FALSE;
  if(isnull(version[1]))return FALSE;

  return version[1];

}

function check_locate(sock) {

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="get_string_version">get_string_version</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>text</dt>
			
		
			<dt>ver_pattern</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function get_string_version(text, ver_pattern) {
  local_var loc_version;

  if( isnull( ver_pattern) ) {           # Standard Version Pattern for most cases
    ver_pattern = &quot;([0-9\.]+)&quot;;
  }
  loc_version = eregmatch(pattern:ver_pattern, string:text);
  if(loc_version != NULL) loc_version[max_index(loc_version)] = text;
  return (loc_version);
}

function version_is_less(version ,test_version, icase) {

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="get_version_from_kb">get_version_from_kb</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>app</dt>
			
		
			<dt>port</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function get_version_from_kb(port,app) {

  local_var port, app, vers, version, matches;

  if( ! port ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#port#-#get_version_from_kb&quot; );
  if( ! app ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#app#-#get_version_from_kb&quot; );

  if(isnull(port) || isnull(app))return FALSE;

  if(!version = get_kb_item(string(&quot;www/&quot;, port, &quot;/&quot;,app)))return FALSE;
  if(!matches = eregmatch(string:version, pattern:&quot;^(.+) under (/.*)$&quot;))return FALSE;

  vers = matches[1];

  if(isnull(vers) || vers == &quot;unknown&quot; || vers == &quot;Unknown&quot; ) return FALSE;

  return string(vers);

}

function get_dir_from_kb(port,app) {

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="report_fixed_ver">report_fixed_ver</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>extra</dt>
			
		
			<dt>fixed_build</dt>
			
		
			<dt>fixed_patch</dt>
			
		
			<dt>fixed_version</dt>
			
		
			<dt>installed_build</dt>
			
		
			<dt>installed_patch</dt>
			
		
			<dt>installed_version</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function report_fixed_ver( installed_version, installed_build, installed_patch,
                           fixed_version, fixed_build, fixed_patch, extra ) {

  local_var installed_version, installed_build, installed_patch, fixed_version, fixed_build, fixed_patch, extra;

  report = &#39;Installed version: &#39; + installed_version + &#39;\n&#39; +
           &#39;Fixed version:     &#39; + fixed_version + &#39;\n&#39;;

  if( installed_build ) report += &#39;Installed build:   &#39; + installed_build + &#39;\n&#39;;
  if( installed_patch ) report += &#39;Installed patch:   &#39; + installed_patch + &#39;\n&#39;;
  if( fixed_build ) report += &#39;Fixed build:       &#39; + fixed_build + &#39;\n&#39;;
  if( fixed_patch ) report += &#39;Fixed patch:       &#39; + fixed_patch + &#39;\n&#39;;
  if( extra ) report += &#39;\n&#39; + extra + &#39;\n&#39;;

  return report;
}


		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="version_in_range">version_in_range</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>test_version</dt>
			
		
			<dt>test_version2</dt>
			
		
			<dt>version</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function version_in_range(version, test_version, test_version2){
  if( ! version ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#version#-#version_in_range&quot; );
  if( ! test_version ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#test_version#-#version_in_range&quot; );
  if( ! test_version2 ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#test_version2#-#version_in_range&quot; );
  if(version_is_greater_equal(version:version, test_version:test_version)){
    if(version_is_less_equal(version:version, test_version:test_version2)) return (1);
  }
  return (0);
}

function get_version_from_kb(port,app) {

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="version_is_equal">version_is_equal</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>icase</dt>
			
		
			<dt>test_version</dt>
			
		
			<dt>version</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function version_is_equal(version, test_version, icase) {
  if( ! version ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#version#-#version_is_equal&quot; );
  if( ! test_version ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#test_version#-#version_is_equal&quot; );
  return (version_test(version:version, test_version:test_version, less:FALSE, icase:icase));
}

function version_test(version, test_version, less, icase) {

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="version_is_greater">version_is_greater</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>test_version</dt>
			
		
			<dt>version</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function version_is_greater(version, test_version) {
  if( ! version ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#version#-#version_is_greater&quot; );
  if( ! test_version ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#test_version#-#version_is_greater&quot; );
  if(version_is_less(version:test_version, test_version:version) ) return (1);
  return (0);
}

function version_in_range(version, test_version, test_version2){

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="version_is_greater_equal">version_is_greater_equal</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>test_version</dt>
			
		
			<dt>version</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function version_is_greater_equal(version, test_version) {
  if( ! version ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#version#-#version_is_greater_equal&quot; );
  if( ! test_version ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#test_version#-#version_is_greater_equal&quot; );
  if(version_is_equal(version:version, test_version:test_version) ) return (1);
  if(version_is_less(version:test_version, test_version:version) ) return (1);
  return (0);
}

function version_is_greater(version, test_version) {

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="version_is_less">version_is_less</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>icase</dt>
			
		
			<dt>test_version</dt>
			
		
			<dt>version</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function version_is_less(version ,test_version, icase) {
  if( ! version ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#version#-#version_is_less&quot; );
  if( ! test_version ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#test_version#-#version_is_less&quot; );
  return (version_test(version:version, test_version:test_version, less:TRUE, icase:icase));
}

function version_is_equal(version, test_version, icase) {

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="version_is_less_equal">version_is_less_equal</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>test_version</dt>
			
		
			<dt>version</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function version_is_less_equal(version, test_version) {
  if( ! version ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#version#-#version_is_less_equal&quot; );
  if( ! test_version ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#test_version#-#version_is_less_equal&quot; );
  if(version_is_equal(version:version, test_version:test_version) ) return (1);
  if(version_is_less(version:version, test_version:test_version) ) return (1);
  return (0);
}

function version_is_greater_equal(version, test_version) {

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="version_test">version_test</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>icase</dt>
			
		
			<dt>less</dt>
			
		
			<dt>test_version</dt>
			
		
			<dt>version</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function version_test(version, test_version, less, icase) {
  local_var ver_ary, test_ary, ver_num, ver_sep, i, r, s, char_found;

  if(isnull(version) || version == &quot;&quot; || version == 0 || version == &#39;0&#39; || version == &quot;unknown&quot; || version == &quot;Unknown&quot; || version == &quot;.&quot;) return FALSE;

  if(isnull(icase) ) icase = TRUE;
  if(icase) {
    version = tolower(version);
    test_version = tolower(test_version);
  }
  ver_sep = ereg_replace(pattern:&quot;([A-Za-z0-9])&quot;, string: version, replace:&quot;&quot;);
  if( ver_sep == &quot;&quot; ) ver_sep = &quot;.&quot;;   # Set Standard Separator
  ver_ary = split(version, sep:ver_sep[0], keep:0);
  ver_sep = ereg_replace(pattern:&quot;([A-Za-z0-9])&quot;, string: test_version, replace:&quot;&quot;);
  if( ver_sep == &quot;&quot; ) ver_sep = &quot;.&quot;;   # Set Standard Separator
  test_ary = split(test_version, sep:ver_sep[0], keep:0);
  while(max_index(ver_ary) &lt; max_index(test_ary) ) {
    ver_ary[max_index(ver_ary)] = &quot;0&quot;;
  }
  while(max_index(ver_ary) &gt; max_index(test_ary) ) {
    test_ary[max_index(test_ary)] = &quot;0&quot;;
  }
  foreach i (keys(test_ary) ) {
    r = eregmatch(pattern:&quot;([0-9]+)&quot;, string:test_ary[i]);
    s = eregmatch(pattern:&quot;([A-Za-z])&quot;, string:test_ary[i]);
    test_rc = eregmatch(pattern:&quot;rc([0-9]+)&quot;, string:test_ary[i]);
    if(isnull(s) ) {
      test_ary[i] = int(r[0]) * 128;                         # Changed to * 128 so if a char follows a number the number is more significant
      char_found = FALSE;
    } else {
      if(isnull(test_rc)) {
        test_ary[i] = (int(r[0]) * 128) + ord(s[0]);
      } else {
        test_ary[i] = test_rc[1];
      }
      char_found = TRUE;
    }
    r = eregmatch(pattern:&quot;([0-9]+)&quot;, string:ver_ary[i]);
    s = eregmatch(pattern:&quot;([A-Za-z])&quot;, string:ver_ary[i]);
    ver_rc = eregmatch(pattern:&quot;rc([0-9]+)&quot;, string:ver_ary[i]);
    if(isnull(s) ) {
      ver_ary[i] = int(r[0]) * 128;
    } else if(char_found) {
             if(isnull(ver_rc)) {
               ver_ary[i] = (int(r[0]) * 128) + ord(s[0]);
	     } else {
                ver_ary[i] = ver_rc[1];
	     }
           } else {
             if(isnull(r) ) {
               ver_ary[i] = ord(s[0]);
             } else {
               if(! less) return (0);			     # If char found in test_version and no char in version it is not equal
	       ver_ary[i] = int(r[0]) * 128;                 # No chars if test_version has no chars on this position else 1.1.1a is &gt; 1.1.2
             }
    }

    if(less) {

      if(ver_ary[i] &lt; test_ary[i]) return (1);
      if(ver_ary[i] &gt; test_ary[i]) return (0);
    } else {
      if(ver_ary[i] != test_ary[i]) return (0);
    }
  }
  if(less) return (0); else return (1);
}

function version_is_less_equal(version, test_version) {

		</pre>
		<a href="#top">top</a>
		<hr>
		
		
		
		
		

	</div><!--/span-->
	</div><!--/row-->

	<hr>

	<footer>
		<p>&copy; Tenable Network Security 2014</p>
	</footer>

  </div><!--/.fluid-container-->

  <!-- Le javascript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script type="text/javascript" src="js/jquery-1.8.2.js"></script>
  <script type="text/javascript" src="js/bootstrap.min.js"></script>
  <script type="text/javascript" src="js/shCore.js"></script>
  <script type="text/javascript" src="js/shBrushNasl.js"></script>

  <script type="text/javascript">
    SyntaxHighlighter.defaults['collapse'] = true;
    SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.all();
  </script>

  </body>
</html>
