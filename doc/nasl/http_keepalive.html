



<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <title>nasldoc: nasl</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!-- Le styles -->
  <style type="text/css">
	body {
	padding-top: 60px;
	padding-bottom: 40px;
	}
	.sidebar-nav {
	padding: 9px 0;
	}
  </style>

  <link href="css/bootstrap.min.css" rel="stylesheet">
  <link href="css/shCore.css" rel="stylesheet" type="text/css" />
  <link href="css/shThemeDefault.css" rel="stylesheet" type="text/css" />

  <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
  <!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <!-- Fav and touch icons -->
  <link rel="shortcut icon" href="ico/favicon.ico">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="ico/apple-touch-icon-144-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="ico/apple-touch-icon-114-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="ico/apple-touch-icon-72-precomposed.png">
  <link rel="apple-touch-icon-precomposed" href="ico/apple-touch-icon-57-precomposed.png">
  </head>

  <body>

	<div class="navbar navbar-inverse navbar-fixed-top">
	  <div class="navbar-inner">
		<div class="container-fluid">
		  <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
		  </a>
		  <a class="brand" href="index.html">nasldoc</a>
		  <div class="nav-collapse collapse">
			<ul class="nav">
			  <li class="active"><a href="index.html">Home</a></li>
			</ul>
		  </div><!--/.nav-collapse -->
		</div>
	  </div>
	</div>

  <div class="container-fluid">
	<div class="row-fluid">
	<div class="span3">
	  <div class="well sidebar-nav">
	  <ul class="nav nav-list">
		
			
			
			<li class="even">
			  <a href="GSHB_BruteForce.html">GSHB_BruteForce.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="GSHB_read_file.html">GSHB_read_file.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="bad_ssh_host_keys.html">bad_ssh_host_keys.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="bad_ssh_keys.html">bad_ssh_keys.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="bin.html">bin.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="byte_func.html">byte_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="cisco_ios.html">cisco_ios.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="cpe.html">cpe.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="default_account.html">default_account.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="default_credentials.html">default_credentials.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="dump.html">dump.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="ftp_func.html">ftp_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="gb_openssl_heartbeat.html">gb_openssl_heartbeat.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="global_settings.html">global_settings.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="gvr_apps_auth_func.html">gvr_apps_auth_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="host_details.html">host_details.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="hp_printers.html">hp_printers.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="http_func.html">http_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="http_keepalive.html">http_keepalive.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="imap_func.html">imap_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="itg.html">itg.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="junos.html">junos.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="kyocera_printers.html">kyocera_printers.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="ldap.html">ldap.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="lexmark_printers.html">lexmark_printers.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="misc_func.html">misc_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="netop.html">netop.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="network_func.html">network_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="nfs_func.html">nfs_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="nmap.html">nmap.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="nntp_func.html">nntp_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="os_eol.html">os_eol.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="pingpong.html">pingpong.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="pkg-lib-bsd.html">pkg-lib-bsd.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="pkg-lib-deb.html">pkg-lib-deb.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="pkg-lib-gentoo.html">pkg-lib-gentoo.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="pkg-lib-hpux.html">pkg-lib-hpux.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="pkg-lib-macosx.html">pkg-lib-macosx.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="pkg-lib-rpm.html">pkg-lib-rpm.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="pkg-lib-slack.html">pkg-lib-slack.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="pop3_func.html">pop3_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="revisions-lib.html">revisions-lib.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="rsync_func.html">rsync_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="secpod_activex.html">secpod_activex.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="secpod_ie_supersede.html">secpod_ie_supersede.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="secpod_reg.html">secpod_reg.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="secpod_smb_func.html">secpod_smb_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="secpod_ssl_ciphers.html">secpod_ssl_ciphers.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="sharp_printers.html">sharp_printers.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="sip.html">sip.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="smb_default_credentials.html">smb_default_credentials.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="smb_nt.html">smb_nt.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="smbcl_func.html">smbcl_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="smtp_func.html">smtp_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="snmp_func.html">snmp_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="solaris.html">solaris.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="ssh_func.html">ssh_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="ssl_funcs.html">ssl_funcs.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="telnet_func.html">telnet_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="tftp.html">tftp.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="uddi.html">uddi.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="url_func.html">url_func.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="version_func.html">version_func.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="vmware_esx.html">vmware_esx.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="wmi_file.html">wmi_file.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="wmi_hardware.html">wmi_hardware.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="wmi_misc.html">wmi_misc.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="wmi_os.html">wmi_os.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="wmi_proc.html">wmi_proc.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="wmi_rsop.html">wmi_rsop.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="wmi_svc.html">wmi_svc.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="wmi_user.html">wmi_user.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="wordlist.html">wordlist.inc</a>
			</li>
		
			
			
			<li class="odd">
			  <a href="xerox_printers.html">xerox_printers.inc</a>
			</li>
		
			
			
			<li class="even">
			  <a href="xml.html">xml.inc</a>
			</li>
		
	  </ul>
	  </div><!--/.well -->
	</div><!--/span-->
	<div class="span9">

		<a name="top"></a>
		<h1>Overview of http_keepalive.inc</h1>
		

		

		<h1>Automatic Includes</h1>
		<p>These files are automatically included by the library.</p>
		<ul>
		  
		  <li><a href="host_details.html">host_details.inc</a></li>
		  
		</ul>
		

		
		
		
		

		<h1>Private Variable Summary</h1>

		
		<p>Private variables are not intended to be accessed by the code that
		imports this library. There is no functional difference between private
		and public variables, only convention, and they may be accessed as
		normal. </p>
		

		<table class="nopad">
		  <tr class="TableHeadingColor">
			<th>Name</th>
			<th>Summary</th>
		  </tr>
		  
		  <tr>
			<td><a href="#__ka_enabled">__ka_enabled</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#__ka_last_request">__ka_last_request</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#__ka_port">__ka_port</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#__ka_socket">__ka_socket</a></td>
			<td></td>
		  </tr>
		  
		</table>
		
		

		
		
		<h1>Public Function Summary</h1>

		
		<p>Public functions are intended to be called by the code that imports
		this library.</p>
		

		<table class="nopad">
		  <tr class="TableHeadingColor">
			<th>Name</th>
			<th>Summary</th>
		  </tr>
		  
		  <tr>
			<td><a href="#check_win_dir_trav_ka">check_win_dir_trav_ka</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#enable_keepalive">enable_keepalive</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#exploit_commands">exploit_commands</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#get_http_page">get_http_page</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#http_check_remote_code">http_check_remote_code</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#http_get_cache">http_get_cache</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#http_get_req">http_get_req</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#http_keepalive_check_connection">http_keepalive_check_connection</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#http_keepalive_enabled">http_keepalive_enabled</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#http_keepalive_recv_body">http_keepalive_recv_body</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#http_keepalive_send_recv">http_keepalive_send_recv</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#http_post_req">http_post_req</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#http_vuln_check">http_vuln_check</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#is_cgi_installed_ka">is_cgi_installed_ka</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#on_exit">on_exit</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#report_vuln_url">report_vuln_url</a></td>
			<td></td>
		  </tr>
		  
		  <tr>
			<td><a href="#traversal_files">traversal_files</a></td>
			<td></td>
		  </tr>
		  
		</table>
		
		
		
		

		
		
		
		
		<h1>Private Variable Details</h1>
		
		<h2 id="__ka_enabled">__ka_enabled</h2>
		

		

		<a href="#top">top</a>
		<hr>
		
		<h2 id="__ka_last_request">__ka_last_request</h2>
		

		

		<a href="#top">top</a>
		<hr>
		
		<h2 id="__ka_port">__ka_port</h2>
		

		

		<a href="#top">top</a>
		<hr>
		
		<h2 id="__ka_socket">__ka_socket</h2>
		

		

		<a href="#top">top</a>
		<hr>
		
		
		

		
		
		<h1>Public Function Details</h1>
		
		<h2 id="check_win_dir_trav_ka">check_win_dir_trav_ka</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>port</dt>
			
		
			<dt>url</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function check_win_dir_trav_ka( port, url ) {

  local_var soc, req, cod, buf;

  if( ! port ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#port#-#check_win_dir_trav_ka&quot; );
  if( ! url ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#url#-#check_win_dir_trav_ka&quot; );

  req = http_get( item:url, port:port );
  buf = http_keepalive_send_recv( port:port, data:req );

  if( &quot;; for 16-bit app support&quot; &gt;&lt; buf || &quot;[boot loader]&quot; &gt;&lt; buf ) {
    return( 1 );
  }
  return( 0 );
}

function is_cgi_installed_ka( item, port, embedded ) {

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="enable_keepalive">enable_keepalive</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>port</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function enable_keepalive( port ) {

  if( ! port ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#port#-#enable_keepalive&quot; );

  __ka_enabled = 1;
  __ka_port    = port;
  __ka_socket  = http_open_socket( port );
}

#

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="exploit_commands">exploit_commands</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function exploit_commands() {

  res = host_runs( &quot;windows&quot; );

  if( res == &quot;yes&quot; ) {

    return make_array( &quot;Windows.IP..onfiguration&quot;, &quot;ipconfig&quot; );

  } else if( res == &quot;no&quot; ) {

    return make_array( &quot;uid=[0-9]+.*gid=[0-9]+&quot;, &quot;id&quot; );

  }

  # unknown
  return make_array( &quot;uid=[0-9]+.*gid=[0-9]+&quot;, &quot;id&quot;,
                     &quot;Windows.IP..onfiguration&quot;, &quot;ipconfig&quot; );

}

function report_vuln_url( port, url, url_only ) {

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="get_http_page">get_http_page</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>port</dt>
			
		
			<dt>redirect</dt>
			
		
			<dt>url</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function get_http_page( port, url, redirect ) {

  local_var r, u, v, i, l, seen_loc, n;

  if( ! port ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#port#-#get_http_page&quot; );
  if( ! port ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#url#-#get_http_page&quot; );

  if( isnull( redirect ) ) {
    n = 32;
  } else if( redirect &lt;= 0 ) {
    n = 1;
  } else {
    n = redirect + 1;
  }

  seen_loc = make_list();
  u = url;
  for( i = 0; i &lt; n; i ++ ) { # Limited iterations to avoid traps
    seen_loc[u] = 1;
    r = http_keepalive_send_recv( port:port, data:http_get( port:port, item:u ) );
    if( isnull( r ) ) return NULL;

    if( r =~ &quot;^HTTP/1\.[01] +30[0-9] .*&quot; ) {
      v = eregmatch( pattern:&#39;\r\nLocation: *([^ \t\r\n]+)[ \t]*[\r\n]+&#39;, string:r, icase:TRUE );
      if( isnull( v ) ) return NULL; # Big problem
      l = v[1];
      if( seen_loc[l] ) return NULL;
      seen_loc[l] = 1;
    } else if( r =~ &quot;^HTTP/1\.[01] +200 &quot; ) {
      r = strstr( r, &#39;\r\n\r\n&#39; );
      r = substr( r, 4 );
      return r;
    } else { # Code 4xx or 5xx
      return NULL;
    }
  }
  # Loop?
  return NULL;
}

function http_get_cache( port, item ) {

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="http_check_remote_code">http_check_remote_code</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>check_request</dt>
			
		
			<dt>check_result</dt>
			
		
			<dt>command</dt>
			
		
			<dt>default_port</dt>
			
		
			<dt>embedded</dt>
			
		
			<dt>extra_check</dt>
			
		
			<dt>extra_dirs</dt>
			
		
			<dt>port</dt>
			
		
			<dt>unique_dir</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function http_check_remote_code( default_port, extra_dirs, unique_dir, check_request, extra_check, check_result, command, port, embedded ) {

  local_var list, req, txt_result, txt_desc, extra, dir, buf;

  if( get_kb_item( &quot;Settings/disable_cgi_scanning&quot; ) ) exit( 0 );

  if( ! check_request ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#check_request#-#http_check_remote_code&quot; );
  if( ! check_result ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#check_result#-#http_check_remote_code&quot; );
  if( ! command ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#command#-#http_check_remote_code&quot; );

  if( ! port ) {
    if( default_port ) {
      port = get_http_port( default:default_port );
    } else {
      port = get_http_port( default:80 );
   }
  }

  if( ! get_port_state( port ) ) exit( 0 );

  if( unique_dir ) {
    list = make_list( unique_dir );
  } else {
    if( ! isnull( extra_dirs ) ) {
      list = make_list( cgi_dirs( port:port ), extra_dirs );
    } else {
      list = make_list( cgi_dirs( port:port ) );
    }
  }

  foreach dir( list ) {

    req = string( dir, check_request );
    req = http_get( item:req, port:port );
    buf = http_keepalive_send_recv( port:port, data:req );
    if( buf == NULL ) exit( 0 ); #TBD: Really exit?

    txt_result = egrep( pattern:check_result, string:buf );
    if( extra_check ) {
      extra = 0;
      if( egrep( pattern:extra_check, string:buf ) ) {
        extra = 1;
      }
    } else {
      extra = 1;
    }

    if( txt_result &amp;&amp; extra ) {
      txt_desc = &#39;It was possible to execute the command &quot;&#39; + command + &#39;&quot; on the remote host, which produces the following output:\n\n&#39; + txt_result;
      security_message( port:port, data:txt_desc );
      exit( 0 );
    }
  }
}

function http_vuln_check( port, url, pattern, check_header, debug, extra_check, hostname, cookie, check_nomatch ) {

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="http_get_cache">http_get_cache</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>item</dt>
			
		
			<dt>port</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function http_get_cache( port, item ) {

  local_var req, res;

  if( ! port ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#port#-#http_get_cache&quot; );
  if( ! item ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#item#-#http_get_cache&quot; );

  res = get_kb_item( &quot;Cache/&quot; + port + &quot;/URL_&quot; + item );
  if( res ) return res;

  req = http_get( port:port, item:item );
  res = http_keepalive_send_recv( port:port, data:req, embedded:TRUE );
  if( ! res ) return NULL;

  replace_kb_item( name:&quot;Cache/&quot; + port + &quot;/URL_&quot; + item, value:res );

  return res;
}

function http_check_remote_code( default_port, extra_dirs, unique_dir, check_request, extra_check, check_result, command, port, embedded ) {

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="http_get_req">http_get_req</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>add_headers</dt>
			
		
			<dt>port</dt>
			
		
			<dt>url</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function http_get_req( port, url, add_headers ) {

  local_var req, port, add_headers, header, url;

  if( typeof( add_headers ) != &quot;array&quot; ) {
    set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#add_headers_no-array#-#http_get_req&quot; );
    return;
  }

  if( ! port ) {
    set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#port#-#http_get_req&quot; );
    return;
  }

  if( ! url ) url = &quot;/&quot;;

  host = http_host_name( port:port );

  req = &#39;GET &#39; + url + &#39; HTTP/1.1\r\n&#39; +
        &#39;Connection: Close\r\n&#39; +
        &#39;Host: &#39; + host + &#39;\r\n&#39; +
        &#39;Pragma: no-cache\r\n&#39; +
        &#39;Cache-Control: no-cache\r\n&#39; +
        &#39;User-Agent: &#39; + OPENVAS_HTTP_USER_AGENT + &#39;\r\n&#39; +
        &#39;Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, image/png, */*\r\n&#39; +
        &#39;Accept-Language: en\r\n&#39; +
        &#39;Accept-Charset: iso-8859-1,*,utf-8\r\n&#39;;

  foreach header( keys( add_headers ) )
    req += header +&#39;: &#39; + add_headers[header] + &#39;\r\n&#39;;

  req += &#39;\r\n&#39;;

  return req;
}


		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="http_keepalive_check_connection">http_keepalive_check_connection</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>headers</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function http_keepalive_check_connection( headers ) {

  local_var tmp;

  if( ! headers ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#headers#-#http_keepalive_check_connection&quot; );

  tmp = egrep( pattern:&quot;^Connection: Close&quot;, string:headers, icase:TRUE );
  if( tmp ) {
    if( __ka_socket ) {
      http_close_socket( __ka_socket );
    }
    __ka_socket = http_open_socket( __ka_port );
  }
}

function enable_keepalive( port ) {

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="http_keepalive_enabled">http_keepalive_enabled</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>port</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function http_keepalive_enabled( port ) {

  local_var req, soc, r, kb;

  if( ! port ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#port#-#http_keepalive_enabled&quot; );

  kb = get_kb_item( strcat( &quot;www/&quot;, port, &quot;/keepalive&quot; ) );

  if( kb == &quot;yes&quot; ) {
    enable_keepalive( port:port );
    return( 1 );
  } else if( kb == &quot;no&quot; ) {
    return( 0 );
  }

  host = http_host_name( port:port );

  req = strcat( &#39;GET / HTTP/1.1\r\n&#39;,
                &#39;Connection: Keep-Alive\r\n&#39;,
                &#39;Host: &#39;, host, &#39;\r\n&#39;,
                &#39;Pragma: no-cache\r\n&#39;,
                &#39;User-Agent: &#39; + OPENVAS_HTTP_USER_AGENT + &#39;\r\n\r\n&#39; );

  soc = http_open_socket( port );
  if( ! soc ) return -2;
  send( socket:soc, data:req );
  r = http_recv( socket:soc );

  # Apache
  if( egrep( pattern:&quot;^Keep-Alive:.*&quot;, string:r, icase:TRUE ) ) {
    http_close_socket( soc );
    set_kb_item( name:strcat( &#39;www/&#39;, port, &#39;/keepalive&#39; ), value:&quot;yes&quot; );
    enable_keepalive( port:port );
    return( 1 );
  } else {
    # IIS
    send( socket:soc, data:req );
    r = http_recv( socket:soc );
    http_close_socket( soc );
    if( strlen( r ) ) {
      set_kb_item( name:strcat( &quot;www/&quot;, port, &quot;/keepalive&quot; ), value:&quot;yes&quot; );
      enable_keepalive( port:port );
      return( 1 );
    }
  }

  set_kb_item( name:strcat( &quot;www/&quot;, port, &quot;/keepalive&quot; ), value:&quot;no&quot; );
  return( 0 );
}

#

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="http_keepalive_recv_body">http_keepalive_recv_body</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>bodyonly</dt>
			
		
			<dt>headers</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function http_keepalive_recv_body( headers, bodyonly ) {

  local_var body, length, tmp, chunked, killme, gzip;

  if( ! headers ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#headers#-#http_keepalive_recv_body&quot; );

  killme = 0;
  length = -1;

  if( ereg( pattern:&quot;^HEAD.*HTTP/.*&quot;, string:__ka_last_request ) ) {
    # HEAD does not return a body
    http_keepalive_check_connection( headers:headers );
    if( bodyonly ) {
      return( &quot;&quot; );
    } else {
      return( headers );
    }
  }

  if( &quot;content-length&quot; &gt;&lt; tolower( headers ) ) {
    tmp = egrep( string:headers, pattern:&quot;^Content-Length: *[0-9]+&quot;, icase:TRUE );
    if( tmp ) length = int( ereg_replace( string:tmp, pattern:&quot;^Content-Length: *([0-9]*) *&quot;, replace:&quot;\1&quot;, icase:TRUE ) );
  }

  if( &quot;content-encoding: gzip&quot; &gt;&lt; tolower( headers ) ) gzip = TRUE;

  if( ( length &lt; 0 ) &amp;&amp; ( egrep( pattern:&quot;transfer-encoding: chunked&quot;, string:headers, icase:TRUE ) ) ) {
    while( 1 ) {
      tmp = recv_line( socket:__ka_socket, length:4096 );
      length = hex2dec( xvalue:tmp );
      if( length &gt; 1048576 ) {
        length = 1048576;
        killme = 1;
      }
      body  = strcat( body, recv( socket:__ka_socket, length:length, min:length ) );
      # &quot;\r\n&quot;
      recv( socket:__ka_socket, length:2, min:2 );
      if( strlen( body ) &gt; 1048576 ) killme = 1;

      if( length == 0 || killme ) {
        http_keepalive_check_connection( headers:headers );
        # This is expected - don&#39;t put this line before the previous
        if( gzip )
          body = http_gunzip( buf:body, onlybody:TRUE );

        if( bodyonly ) {
          return( body );
        } else {
          return( strcat( headers, &#39;\r\n&#39;, body ) );
        }
      }
    }
  }

  if( length &gt;= 0 ) {
    # Don&#39;t receive more than 1 MB
    if( length &gt; 1048576 ) length = 1048576;

    body = recv( socket:__ka_socket, length:length, min:length );
  } else {
    # If we don&#39;t have the length, we close the connection to make sure
    # the next request won&#39;t mix up the replies.

    #display(&quot;ERROR - Keep Alive, but no length!!!\n&quot;, __ka_last_request);
    body = recv( socket:__ka_socket, length:16384, min:0 );
    if( body =~ &#39;&lt;html[^&gt;]*&gt;&#39; &amp;&amp; body !~ &#39;&lt;/html&gt;&#39; ) { # case insensitive
      repeat {
        tmp = recv( socket:__ka_socket, length:16384 );
        body += tmp;
      }
      until( ! tmp || body =~ &quot;&lt;/html&gt;&quot; );
      if( debug_level &amp;&amp; body !~ &quot;&lt;/html&gt;&quot; ) display( &quot;http_keepalive_recv_body: incomplete body?\n------------\n&quot;, body, &quot;\n------------\n&quot; );
    }
    http_close_socket( __ka_socket );
    __ka_socket = http_open_socket( __ka_port );
  }

  http_keepalive_check_connection( headers:headers );

  if( gzip )
    body = http_gunzip( buf:body, onlybody:TRUE );

  if( bodyonly ) {
    return( body );
  } else {
    return( strcat( headers, &#39;\r\n&#39;, body ) );
  }
}

# We close our socket on exit.

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="http_keepalive_send_recv">http_keepalive_send_recv</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>bodyonly</dt>
			
		
			<dt>data</dt>
			
		
			<dt>embedded</dt>
			
		
			<dt>fetch404</dt>
			
		
			<dt>port</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function http_keepalive_send_recv( port, data, bodyonly, embedded, fetch404 ) {

  local_var id, n, ret, headers;
  local_var soc, r, body;

  if( ! port ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#port#-#http_keepalive_send_recv&quot; );
  if( ! data ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#data#-#http_keepalive_send_recv&quot; );

  if( debug_level &gt; 1 )
    display( &quot;http_keepalive_send_recv( port: &quot;, port, &quot;, data: &quot;, data, &quot;, bodyonly: &quot;, bodyonly, &quot; )\n&quot; );

  if( ! data ) return NULL;

  if( __ka_enabled == -1 ) __ka_enabled = http_keepalive_enabled( port:port );
  if( __ka_enabled == -2 ) return NULL;

  if( __ka_enabled == 0 ) {
    soc = http_open_socket( port );
    if( ! soc ) return NULL;
    if( send( socket:soc, data:data ) &lt;= 0 ) {
      http_close_socket( soc );
      return NULL;
    }
    headers = http_recv_headers2( socket:soc );
    # If the headers are not HTTP compliant, just return right away
    if( headers &amp;&amp; ! ereg( pattern:&quot;^HTTP/.* [0-9]+&quot;, string:headers ) )
      return headers;

    if( headers &amp;&amp; ( ! ereg( pattern:&quot;^HTTP/.* 404&quot;, string:headers ) || fetch404 == TRUE ) )
      body = http_recv_body( socket:soc, headers:headers, length:0 );

    http_close_socket( soc );

    if( &quot;content-encoding: gzip&quot; &gt;&lt; tolower( headers ) )
      body = http_gunzip( buf:body, onlybody:TRUE );

    if( bodyonly ) {
      return( body );
    } else {
      return( strcat( headers, &#39;\r\n&#39;, body ) );
    }
  }

  if( ( port != __ka_port ) || ( ! __ka_socket ) ) {
    if( __ka_socket ) http_close_socket( __ka_socket );
    __ka_port = port;
    __ka_socket = http_open_socket( port );
    if( ! __ka_socket ) return NULL;
  }

  id = stridx( data, &#39;\r\n\r\n&#39; );
  data = str_replace( string:data, find:&quot;Connection: Close&quot;, replace:&quot;Connection: Keep-Alive&quot;, count:1 );
  __ka_last_request = data;
  n = send( socket:__ka_socket, data:data );
  if( n &gt;= strlen( data ) )
    headers = http_recv_headers2( socket:__ka_socket );
  if( ! headers ) {
    http_close_socket( __ka_socket );
    __ka_socket = http_open_socket( __ka_port );
    if( __ka_socket == 0 ) return NULL;
    if( send( socket:__ka_socket, data:data ) &lt; strlen( data ) ) {
      http_close_socket( __ka_socket );
      __ka_socket = NULL;
      return NULL;
    }
    headers = http_recv_headers2( socket:__ka_socket );
  }
  return http_keepalive_recv_body( headers:headers, bodyonly:bodyonly );
}

#

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="http_post_req">http_post_req</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>accept_header</dt>
			
		
			<dt>add_headers</dt>
			
		
			<dt>data</dt>
			
		
			<dt>port</dt>
			
		
			<dt>url</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function http_post_req( port, url, data, add_headers, accept_header ) {

  local_var req, port, data, add_headers, header, accept_header;

  if( typeof( add_headers ) != &quot;array&quot; ) {
    set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#add_headers_no-array#-#http_post_req&quot; );
    return;
  }

  if( ! port ) {
    set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#port#-#http_post_req&quot; );
    return;
  }

  if( ! url ) url = &quot;/&quot;;

  if( data ) len = strlen( data );

  host = http_host_name( port:port );
  if( ! accept_header ) accept_header = &#39;*/*&#39;;

  req = &#39;POST &#39; + url + &#39; HTTP/1.1\r\n&#39; +
        &#39;Host: &#39; + host + &#39;\r\n&#39; +
        &#39;Pragma: no-cache\r\n&#39; +
        &#39;User-Agent: &#39; + OPENVAS_HTTP_USER_AGENT + &#39;\r\n&#39; +
        &#39;Accept-Language: en\r\n&#39; +
        &#39;Accept-Charset: iso-8859-1,utf-8;q=0.9,*;q=0.1\r\n&#39; +
        &#39;Accept: &#39; + accept_header + &#39;\r\n&#39; +
        &#39;Accept-Encoding: identity\r\n&#39;;

  if( data ) req += &#39;Content-Length: &#39; + len + &#39;\r\n&#39;;

  foreach header( keys( add_headers ) )
    req += header +&#39;: &#39; + add_headers[header] + &#39;\r\n&#39;;

  req += &#39;\r\n&#39;;

  if( data ) req += data;

  return req;
}

function http_get_req( port, url, add_headers ) {

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="http_vuln_check">http_vuln_check</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>check_header</dt>
			
		
			<dt>check_nomatch</dt>
			
		
			<dt>cookie</dt>
			
		
			<dt>debug</dt>
			
		
			<dt>extra_check</dt>
			
		
			<dt>hostname</dt>
			
		
			<dt>pattern</dt>
			
		
			<dt>port</dt>
			
		
			<dt>url</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function http_vuln_check( port, url, pattern, check_header, debug, extra_check, hostname, cookie, check_nomatch ) {

  local_var port, url, pattern, req, buf, debug, bodyonly, check_header, cookie, check_nomatch;

  if( ! url ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#url#-#http_vuln_check&quot; );
  if( ! port ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#port#-#http_vuln_check&quot; );

  if( isnull( pattern ) || pattern == &quot;&quot; ) {
    set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#pattern#-#http_vuln_check&quot; );
    return FALSE;
  }

  req = http_get( item:url, port:port );

  if( COMMAND_LINE ) { # set hostname for vhosts on command line if hostname parameter was given.
    if( hostname ) {
      req = ereg_replace( string:req, pattern:&quot;Host:.*&quot; + get_host_ip(), replace: &quot;Host: &quot; + hostname );
    }
  }

  if( cookie &amp;&amp; ! isnull( cookie ) )
    req = ereg_replace( string:req, pattern:&#39;\r\n\r\n&#39;, replace: &#39;\r\nCookie: &#39; + cookie + &#39;\r\n\r\n&#39; );

  buf = http_keepalive_send_recv( port:port, data:req );
  if( buf == NULL ) return FALSE;

  __ka_last_request = req;

  if( debug ) {
    display( &quot;\nContent:\n&quot;, buf, &quot;\n&quot; );
  }

  if( check_header == TRUE ) {
    if( ! ereg( pattern:&quot;^HTTP/[0-9]\.[0-9] 200.*&quot;, string:buf ) ) {
      return FALSE;
    }
  }

  ## Extra check for Strings to match in the buf
  if( extra_check ) {
    if( typeof( extra_check ) != &quot;array&quot; ) {
      extra_check = make_list( extra_check );
    }

    foreach ec( extra_check ) {
      if( ! egrep( pattern:ec, string:buf, icase:TRUE ) ) {
        return FALSE;
      }
    }
  }

  ## Check for Strings that should not match in buf
  if( check_nomatch ) {
    if( typeof( check_nomatch ) != &quot;array&quot; ) {
      check_nomatch = make_list( check_nomatch );
    }

    foreach nm( check_nomatch ) {
      if( egrep( pattern:nm, string:buf, icase:TRUE ) ) {
        return FALSE;
      }
    }
  }

  if( egrep( pattern:pattern, string:buf, icase:TRUE ) ) {
    return buf;
  }
  return FALSE;
}

function traversal_files() {

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="is_cgi_installed_ka">is_cgi_installed_ka</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>embedded</dt>
			
		
			<dt>item</dt>
			
		
			<dt>port</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function is_cgi_installed_ka( item, port, embedded ) {

  local_var r, no404, dir, slash, dirs, banner;

  if( ! port ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#port#-#is_cgi_installed_ka&quot; );

  if( get_kb_item( &quot;Settings/disable_cgi_scanning&quot; ) ) return 0;

  banner = get_http_banner( port:port );

  if( item[0] != &quot;/&quot; ) {
    dirs = cgi_dirs( port:port );
    slash = &quot;/&quot;;
  } else {
    dirs = make_list( &quot;&quot; );
    slash = &quot;&quot;;
  }

  no404 = get_kb_item( strcat( &quot;www/no404/&quot;, port ) );
  if( strlen( no404 ) &gt;= 1 ) return NULL;

  foreach dir( dirs ) {

    if( dir == &quot;/&quot; ) dir = &quot;&quot;;

    if( dir != &quot;&quot; ) {
      # some server return a 404 for / but sometimes not for all subdirs. so check again...
      ti = &#39;openvas_&#39; + rand() + &#39;.html&#39;;
      t =  http_keepalive_send_recv( port:port, data:http_get( item:dir + slash + ti, port:port ) );

      if( t =~ &quot;^HTTP/1\.[0-9.] +200&quot; ) continue;
    }

    r = http_keepalive_send_recv( port:port, data:http_get( item:dir + slash + item, port:port ) );
    if( r == NULL ) continue;

    if( r =~ &quot;^HTTP/1\.[0-9.] +200 +&quot; &amp;&amp; &quot;Proxy-Agent: IWSS&quot; &gt;!&lt; r ) {
      if( no404 &amp;&amp; tolower( no404 ) &gt;&lt; tolower( r ) ) {
        continue;
      } else {
        return( 1 );
      }
    }
  }
  return( 0 );
}

function get_http_page( port, url, redirect ) {

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="on_exit">on_exit</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function on_exit() {
  if( __ka_socket ) {
    http_close_socket( __ka_socket );
    __ka_socket = 0;
  }
}

if( 0 ) on_exit(); #TBD: Whats the purpose of this?

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="report_vuln_url">report_vuln_url</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
			<dt>port</dt>
			
		
			<dt>url</dt>
			
		
			<dt>url_only</dt>
			
		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function report_vuln_url( port, url, url_only ) {

  local_var proto, host, report, port, url, url_only;

  if( ! port ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#port#-#report_vuln_url&quot; );
  if( ! url ) set_kb_item( name: &quot;nvt_debug_empty/&quot; + get_script_oid(), value:get_script_oid() + &quot;#-#url#-#report_vuln_url&quot; );

  proto = &#39;http&#39;;
  if( get_port_transport( port ) &gt; 1 ) proto = &#39;https&#39;;

  host = http_host_name( port:port );

  if( url_only ) {
    report = proto + &#39;://&#39; + host + url;
  } else {
    report = &#39;Vulnerable url: &#39; + proto + &#39;://&#39; + host + url;
  }

  return report;
}

# req = http_post_req( port:port, url:&quot;/&quot;, data:data, accept_header:&quot;application/json&quot;, add_headers: make_array( &quot;Content-Type&quot;, &quot;application/x-www-form-urlencoded&quot; ) );

		</pre>
		<a href="#top">top</a>
		<hr>
		
		<h2 id="traversal_files">traversal_files</h2>
		

		

		
		<h3>Named Parameters</h3>
		<dl>

		
		</dl>
		

		

		<h3>Code</h3>
                <!-- The contents must not have indentation, else formatting is off. -->
		<pre class="brush: nasl">
function traversal_files() {

  if( _FCT_ANON_ARGS[0] ) {

    if( tolower( _FCT_ANON_ARGS[0] ) == &quot;windows&quot; ) {
      res = &quot;yes&quot;;
    } else if( tolower( _FCT_ANON_ARGS[0] ) == &quot;linux&quot; ) {
      res = &quot;no&quot;;
    }
  } else {
    if( ! defined_func( &quot;host_runs&quot; ) ) include( &quot;host_details.inc&quot; );
    res = host_runs( &quot;windows&quot; );
  }

  if( res == &quot;yes&quot; ) {

    return make_array( &quot;\[boot loader\]&quot;, &quot;boot.ini&quot;,
                       &quot;; for 16-bit app supporT&quot;, &quot;winnt/win.ini&quot;,
                       &quot;; for 16-bit app support&quot;, &quot;windows/win.ini&quot; );

  } else if( res == &quot;no&quot; ) {

    return make_array( &quot;root:.*:0:[01]:&quot;, &quot;etc/passwd&quot; ); # TBD: Also check e.g. etc/hosts for basic IDS?

  }

  # &quot;unknown&quot;
  return make_array( &quot;root:.*:0:[01]:&quot;, &quot;etc/passwd&quot;,
                     &quot;\[boot loader\]&quot;, &quot;boot.ini&quot;,
                     &quot;; for 16-bit app supporT&quot;, &quot;winnt/win.ini&quot;,
                     &quot;; for 16-bit app support&quot;, &quot;windows/win.ini&quot; );
}

function exploit_commands() {

		</pre>
		<a href="#top">top</a>
		<hr>
		
		
		
		
		

	</div><!--/span-->
	</div><!--/row-->

	<hr>

	<footer>
		<p>&copy; Tenable Network Security 2014</p>
	</footer>

  </div><!--/.fluid-container-->

  <!-- Le javascript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script type="text/javascript" src="js/jquery-1.8.2.js"></script>
  <script type="text/javascript" src="js/bootstrap.min.js"></script>
  <script type="text/javascript" src="js/shCore.js"></script>
  <script type="text/javascript" src="js/shBrushNasl.js"></script>

  <script type="text/javascript">
    SyntaxHighlighter.defaults['collapse'] = true;
    SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.all();
  </script>

  </body>
</html>
