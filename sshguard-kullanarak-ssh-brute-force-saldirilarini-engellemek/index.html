<!doctype html>
<html class="no-js" lang="tr-TR">
<head>
  <meta charset="UTF-8">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  <title>SSHGuard kullanarak SSH Brute Force saldırılarını engellemek | Mertcan GÖKGÖZ</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Jekyll">
  <link href="https://plus.google.com/103305118431759296457" rel="publisher" />
  <!-- Begin Jekyll SEO tag v2.1.0 -->
<meta property="og:title" content="SSHGuard kullanarak SSH Brute Force saldırılarını engellemek" />
<meta name="description" content="SSHGuard C dili ile yazılmış hızlı ve hafif bir uygulamadır günlük aktiviteleri takip ederek büyük çaptaki saldırılara karşı sisteminizi korumaya" />
<meta property="og:description" content="SSHGuard C dili ile yazılmış hızlı ve hafif bir uygulamadır günlük aktiviteleri takip ederek büyük çaptaki saldırılara karşı sisteminizi korumaya" />
<link rel="canonical" href="https://mertcangokgoz.com/sshguard-kullanarak-ssh-brute-force-saldirilarini-engellemek/" />
<meta property="og:url" content="https://mertcangokgoz.com/sshguard-kullanarak-ssh-brute-force-saldirilarini-engellemek/" />
<meta property="og:site_name" content="Mertcan GÖKGÖZ - Özgür Yazılım, Sunucu Yönetimi ve Hizmetleri" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2013-10-13T18:20:42+03:00" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@mertcangokgoz" />
<meta name="twitter:creator" content="@http://twitter.com/mertcangokgoz" />
<script type="application/ld+json">
{"@context": "http://schema.org",
"@type": "BlogPosting",
"headline": "SSHGuard kullanarak SSH Brute Force saldırılarını engellemek",
"datePublished": "2013-10-13T18:20:42+03:00",
"description": "SSHGuard C dili ile yazılmış hızlı ve hafif bir uygulamadır günlük aktiviteleri takip ederek büyük çaptaki saldırılara karşı sisteminizi korumaya",
"url": "https://mertcangokgoz.com/sshguard-kullanarak-ssh-brute-force-saldirilarini-engellemek/"}</script>
<!-- End Jekyll SEO tag -->

  
  <meta name="author" content="Mertcan GÖKGÖZ" />
  <meta name="distribution" content="global"/>
  <meta name="robots" content="follow, all"/>
  <meta name="google-site-verification" content="72uYg4UxAer0YwWdtkU93OGqjNq7ZThpqe0M4KxyvIg"/>
  <meta name='yandex-verification' content='410f2e33fe81ce80'/>
  <meta name="msvalidate.01" content="2183CAED5258723C183F825A20DF9C4A"/>
  <link rel="alternate" type="application/rss+xml" title="Mertcan GÖKGÖZ" href="https://mertcangokgoz.com/feed" />
  <link rel="stylesheet" type="text/css" media="screen" href="/assets/css/all.css">
  <link rel="stylesheet" type="text/css" media="print" href="/assets/css/print.css">
  <link rel="stylesheet" type="text/css" href="/assets/css/font-awesome.min.css">
  <script type="text/javascript" src="/assets/js/jquery-1.12.4.min.js"></script>
  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
  <link rel="shortcut icon" href="/favicon.png">
  <link rel="apple-touch-icon-precomposed" href="/apple-touch-icon-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/apple-touch-icon-72x72-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/apple-touch-icon-114x114-precomposed.png">
</head>
<body>
<div class="container">
    <div class="three columns sidebar">
      <nav class="nav">
  <a href="/">
    <img src="/YeniResimBro.jpg" id="gravatar" alt="Mertcan GÖKGÖZ" width="200" height="200"/>
  </a>
  <h3><a href="/">Mertcan GÖKGÖZ</a></h3>
  <div id="bio">
    <p>
        Kategoriler:<br>

        <a href="/category/linux">Linux</a> &raquo; 236 Yazı<br><a href="/category/programlama">Programlama</a> &raquo; 79 Yazı<br><a href="/category/genel">Genel</a> &raquo; 69 Yazı<br><a href="/category/guvenlik">Guvenlik</a> &raquo; 54 Yazı<br><a href="/category/windows">Windows</a> &raquo; 36 Yazı<br><a href="/category/analiz">Analiz</a> &raquo; 21 Yazı<br><a href="/category/jekyll">Jekyll</a> &raquo; 16 Yazı<br><a href="/category/nginx">Nginx</a> &raquo; 15 Yazı<br><a href="/category/egitimler">Egitimler</a> &raquo; 6 Yazı<br>
        <br>
        Arkadaşlar:<br>
        <a href="https://oztaser.com/" target="_blank" rel="nofollow">Adil ÖZTAŞER</a><br>
        <a href="https://aligoren.com/" target="_blank" rel="nofollow">Ali GÖREN</a><br>
        <a href="https://www.ceyhanmolla.com/" target="_blank" rel="nofollow">Ceyhan MOLLA</a><br>
        <a href="https://0x6.pw/" target="_blank" rel="nofollow">Enes ERGÜN</a><br>
        <a href="http://furkankalkan.com/" target="_blank" rel="nofollow">Furkan KALKAN</a><br>
        <a href="http://www.hamdicatal.com/" target="_blank" rel="nofollow">Hamdi ÇATAL</a><br>
        <a href="https://onur.im/" target="_blank" rel="nofollow">Onur ASLAN</a><br>
        <a href="http://www.omeripek.com.tr" target="_blank" rel="nofollow">Ömer IPEK</a><br>
        <a href="https://yapaygerizeka.github.io/" target="_blank" rel="nofollow">Yapay Geri Zekâ</a><br>
    </p>
  </div>
  <div id="social">
    Takip Edin:
<div id="stalker">
   

   
   <a title="MertcanGokgoz on Academia" href="https://baskent.academia.edu/MertcanGokgoz" target="_blank" rel="nofollow">
     <i class="fa fa-book"></i>
   </a>
   

  
  <a title="MertcanGokgoz on Github" href="https://github.com/MertcanGokgoz" target="_blank" rel="nofollow">
    <i class="fa fa-github-square"></i>
  </a>
  

  
  <a title="MertcanGokgoz on Gitlab" href="https://gitlab.com/u/MertcanGokgoz" target="_blank" rel="nofollow">
    <i class="fa fa-gitlab"></i>
  </a>
  

  

  

  

  

  

  
  <a title="mertcangokgoz on Twitter" href="https://twitter.com/mertcangokgoz" target="_blank" rel="nofollow">
    <i class="fa fa-twitter-square"></i>
  </a>
  

  

  

  
  <a title="Mertcan GÖKGÖZ on LinkedIn" href="https://www.linkedin.com/in/mertcangokgoz" target="_blank" rel="nofollow">
    <i class="fa fa-linkedin-square"></i>
  </a>
  

  
  <a title="Mertcan GÖKGÖZ on Google Plus" href="https://plus.google.com/103305118431759296457" target="_blank" rel="nofollow">
    <i class="fa fa-google-plus-square"></i>
  </a>
  

  

  
  <a title="Mertcan GÖKGÖZ on Youtube" href="https://www.youtube.com/c/MertcanGokgoz" target="_blank" rel="nofollow">
    <i class="fa fa-youtube"></i>
  </a>
  

  
  <a title="RSS feed" id="atom" href="/feed/">
    <i class="fa fa-rss-square"></i>
  </a>
  
</div>

  </div>
</nav>

    </div>
    <div class="nine columns content">
        <div class="menuM">
    <ul class="topnav">
        <li><a class="active" href="https://mertcangokgoz.com/">Anasayfa</a></li>
        <li><a href="https://mertcangokgoz.com/category/analiz/">Analiz</a></li>
        <li><a href="https://mertcangokgoz.com/category/genel/">Genel</a></li>
        <li><a href="https://mertcangokgoz.com/category/guvenlik/">Güvenlik</a></li>
        <li><a href="https://mertcangokgoz.com/category/linux/">Linux</a></li>
        <li><a href="https://mertcangokgoz.com/category/windows/">Windows</a></li>
        <li><a href="https://mertcangokgoz.com/category/jekyll/">Jekyll</a></li>
        <li><a href="https://mertcangokgoz.com/category/nginx/">Nginx</a></li>
        <li><a href="https://mertcangokgoz.com/category/egitimler/">Egitimler</a></li>
        <li><a href="https://mertcangokgoz.com/category/programlama/">Programlama</a></li>
        <li class="icon">
            <a href="javascript:void(0);" style="font-size:15px;" onclick="myFunction()"><i class="fa fa-bars"></i></a>
        </li>
    </ul>
</div>

<script>
    function myFunction() {
        document.getElementsByClassName("topnav")[0].classList.toggle("responsive");
    }
</script>


<p class="meta">
  October 13, 2013
  <a href="/">
    <i class="home fa fa-home fa-2x"></i>
  </a>
  <a href="/search/">
    <i class="home fa fa-search fa-2x"></i>
  </a>
  <a href="javascript:" onclick="window.print();return false;">
    <i class="home fa fa-print fa-2x"></i>
  </a>
</p>

<h1 class="title">SSHGuard kullanarak SSH Brute Force saldırılarını engellemek</h1>

<div id="post">
  <p><a href="http://www.sshguard.net/">SSHGuard</a> C dili ile yazılmış hızlı ve hafif bir uygulamadır günlük aktiviteleri takip ederek büyük çaptaki saldırılara karşı sisteminizi korumaya yardımcı olur.Eğer bir kişi sürekli olarak SSH üzerinden sunucuya ulaşmaya çalışır ise uygulama sizin yerinize iptables düzenlemesi yaparak saldırı alınan ip adresini engeller.Daha sonra ise saldırı durduğu zaman engellenen ip adresini serbest bırakır.</p>

<p><img src="/assets/sshguardimages11.jpg" alt="sshguardimages1" /></p>

<h1 id="sshguard-kurulumu">SSHGuard Kurulumu</h1>

<p>centos 5 üzerine ben kurulumu yaptığımdan dolayı aşağıdaki adımları yaparken göz önünde bulundurunuz</p>

<blockquote>
  <p>rpm -ivh http://flexbox.sourceforge.net/centos/5/i386/sshguard-1.5-2.el5.i386.rpm</p>
</blockquote>

<p>Diğer sistemler de kullanmak isteyenler <a href="http://pkgs.org/download/sshguard">Tıklayın</a></p>

<h1 id="sshguard-iin-iptablesnetfilter-yaplandrmas">SSHGuard için iptables/Netfilter yapılandırması</h1>

<p>SSHGuard için ipfilterde yapılandırma dosyası yoktur.yapılacak tek şey engelleme kurallarını engellemek için SSHGuarda izin vermek ve gereken ayarlamaları yapmaktır.</p>

<p>ipv4 için</p>

<blockquote>
  <p>iptables -N sshguard</p>
</blockquote>

<p>ipv6 için</p>

<blockquote>
  <p>ip6tables -N sshguard</p>
</blockquote>

<p>Girişleri güncelledikten sonra –dport özelliğini kullanarak portları da koruyabilirsiniz yada portlara erişimi tamamen kapatmak isteyebilirsiniz.</p>

<h2 id="saldrganlara-kar-tm-trafiin-engellenmesi">Saldırganlara karşı tüm trafiğin engellenmesi</h2>

<p>ipv4 için</p>

<blockquote>
  <p>iptables -A INPUT -j sshguard</p>
</blockquote>

<p>ipv6 için</p>

<blockquote>
  <p>ip6tables -A INPUT -j sshguard</p>
</blockquote>

<h2 id="saldrganlara-kar-ssh-ftp-pop-imap-belirli-hizmetlerin-engellenmesi">Saldırganlara karşı SSH, FTP, POP, IMAP belirli hizmetlerin engellenmesi</h2>

<p>ipv4 için</p>

<blockquote>
  <p>iptables -A INPUT -m multiport -p tcp –destination-ports 21,22,110,143 -j sshguard</p>
</blockquote>

<p>ipv6 için</p>

<blockquote>
  <p>ip6tables -A INPUT -m multiport -p tcp –destination-ports 21,22,110,143 -j sshguard</p>
</blockquote>

<p>Sonrasında kuralları kayıt edip çıkın</p>

<blockquote>
  <p>service iptables save</p>
</blockquote>

<ul>
  <li>Mümkün olduğunda tüm SSH trafiğini sunucuya kabul etmeyin</li>
  <li>Varsayılan güvenlik duvarı ayarlarını mutlaka kendinize göre düzenlemeyi unutmayın</li>
</ul>

<h2 id="bir-ka-iptables-rnei">Bir kaç iptables Örneği</h2>

<h4 id="sshguardn-kt-dedii-hereyi-yasaklatmak">SSHGuardın kötü dediği herşeyi yasaklatmak</h4>

<blockquote>
  <p>iptables -A INPUT -j sshguard</p>
</blockquote>

<h4 id="trafie-amak-isterseniz">Trafiğe açmak isterseniz</h4>

<blockquote>
  <p>iptables -A INPUT -p tcp –dport 22 -j ACCEPT
iptables -A INPUT -p udp –dport 53 -j ACCEPT
iptables -A INPUT -p tcp –dport 80 -j ACCEPT
iptables -A INPUT -p tcp –dport 443 -j ACCEPT</p>
</blockquote>

<h5 id="hereyi-yasaklamak-iin">Herşeyi Yasaklamak için</h5>

<blockquote>
  <p>iptables -P INPUT DROP
# iptables/netfilter kullanmadan SSHGuard yapılandırma</p>
</blockquote>

<p>eğer detaylı bir şekilde iptables kullanmak istemezseniz aşağıdaki komutları kullanarak sshguard izinleri dışında kimsenin işlem yapamamasını sağlayabilirsiniz.</p>

<blockquote>
  <p>iptables -F
iptables -X
iptables -P INPUT ACCEPT
iptables -P FORWARD ACCEPT
iptables -P OUTPUT ACCEPT
iptables -N sshguard
iptables -A INPUT -j sshguard</p>
</blockquote>

<p>Son olarak da kayıt ediyoruz ve işlemimiz tamamlanıyor.</p>

<blockquote>
  <p>service iptables save</p>
</blockquote>

</div>

<hr style="margin:20px;">
<p><small class="edit">Bir şeyler bu yazıda doğru ya da eksik değil mi? <a href="https://github.com/MertcanGokgoz/mertcangokgoz.github.io/edit/jekyll/_posts/2013-10-13-sshguard-kullanarak-ssh-brute-force-saldirilarini-engellemek.md" target="_blank">Düzenleyin ve pull request Oluşturun</a></small></p>


<div id="paylasim">
<h3>Bu yazıyı paylaş:</h3>
<a href="https://www.facebook.com/sharer/sharer.php?u=https://mertcangokgoz.com/sshguard-kullanarak-ssh-brute-force-saldirilarini-engellemek/" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" >
    <i class="fa fa-facebook-square fa share-button"> Facebook</i>
</a>
<a href="https://twitter.com/intent/tweet?text=SSHGuard kullanarak SSH Brute Force saldırılarını engellemek&url=https://mertcangokgoz.com/sshguard-kullanarak-ssh-brute-force-saldirilarini-engellemek/&via=mertcangokgoz&related=mertcangokgoz" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;">
    <i class="fa fa-twitter-square fa share-button"> Twitter</i>
</a>
<a href="https://plus.google.com/share?url=https://mertcangokgoz.com/sshguard-kullanarak-ssh-brute-force-saldirilarini-engellemek/" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" >
    <i class="fa fa-google-plus-square fa share-button"> Google</i>
</a>
<a href="http://www.reddit.com/submit?url=https://mertcangokgoz.com/sshguard-kullanarak-ssh-brute-force-saldirilarini-engellemek/&title=SSHGuard kullanarak SSH Brute Force saldırılarını engellemek" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;" >
    <i class="fa fa-reddit-square fa share-button"> Reddit</i>
</a>
<a href="https://www.linkedin.com/shareArticle?mini=true&url=https://mertcangokgoz.com/sshguard-kullanarak-ssh-brute-force-saldirilarini-engellemek/&title=SSHGuard kullanarak SSH Brute Force saldırılarını engellemek&summary=&source=webjeda" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" >
    <i class="fa fa-linkedin-square fa share-button"> Linkedin</i>
</a>
<a href="mailto:?subject=SSHGuard kullanarak SSH Brute Force saldırılarını engellemek&amp;body=Check out this site https://mertcangokgoz.com/sshguard-kullanarak-ssh-brute-force-saldirilarini-engellemek/">
    <i class="fa fa-envelope-square fa share-button"> Email</i>
</a>
</div>


<div class="ajaxloadcomment"><button class="show-comments">Yorumları yükle</button></div>
<div itemprop="comment" id="disqus_thread"></div>
<script>
$(document).ready(function() {
    $('.show-comments').on('click', function(){
          var disqus_shortname = 'mertcanofficial';

          $.ajax({
                  type: "GET",
                  url: "//" + disqus_shortname + ".disqus.com/embed.js",
                  dataType: "script",
                  cache: true
          });
          $(this).fadeOut();
    });
});
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>



      <div class="footer">
        <div class="disclaimer">
  
  <p>
    Bu sitedeki gönderiler bana aittir ve iş verenime ait pozisyonlar,
    stratejiler veya görüşler temsil edilmemektedir.<br>
        <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Atıf-Paylaşım Lisansı</a> altındadır.<br>
        <a href="/ders-notlari/">Ders Notları</a>
        <span> | </span><a href="/gizlilik-politikasi/">Gizlilik Politikası</a>
        <span> | </span><a href="/kullanim-kosullari/">Kullanım Koşulları</a>
        <span> | </span><a href="/hakkimda/">Hakkımda</a>
        <span> | </span><a href="/iletisim/">İletişim</a><br>
        <b>BTC:</b> 36DFx4anTdsx3AnBiA1oqR3oHkMV3RJME1<br>
        <a href="/hosted/">Hosted By </a> © Mertcan GÖKGÖZ, 2017 - Linux Hacısı
  </p>
  
</div>

      </div>
    </div>
  </div>
  <div id="up">
    <a href="javascript:"><i class="fa fa-arrow-up fa-2x"></i></a>
  </div>







</body>
</html>
