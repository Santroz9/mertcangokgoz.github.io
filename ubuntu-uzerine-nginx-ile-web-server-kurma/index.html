<!doctype html>
<html class="no-js" lang="tr-TR">
<head>
  <meta charset="UTF-8">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  <title>Ubuntu Üzerine Nginx ile Web Server Kurma | Mertcan GÖKGÖZ</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Jekyll">
  <link href="https://plus.google.com/103305118431759296457" rel="publisher" />
  <!-- Begin Jekyll SEO tag v2.1.0 -->
<meta property="og:title" content="Ubuntu Üzerine Nginx ile Web Server Kurma" />
<meta name="description" content="Kuracağımız sistem tamamen performansa yönelik olacak bunu baştan belirteyim yapımızı Nginx ile kuracağız uzatmadan detaylara geçelim ve" />
<meta property="og:description" content="Kuracağımız sistem tamamen performansa yönelik olacak bunu baştan belirteyim yapımızı Nginx ile kuracağız uzatmadan detaylara geçelim ve" />
<link rel="canonical" href="https://mertcangokgoz.com/ubuntu-uzerine-nginx-ile-web-server-kurma/" />
<meta property="og:url" content="https://mertcangokgoz.com/ubuntu-uzerine-nginx-ile-web-server-kurma/" />
<meta property="og:site_name" content="Mertcan GÖKGÖZ - Özgür Yazılım, Sunucu Yönetimi ve Hizmetleri" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2015-04-29T18:37:25+03:00" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@mertcangokgoz" />
<meta name="twitter:creator" content="@http://twitter.com/mertcangokgoz" />
<script type="application/ld+json">
{"@context": "http://schema.org",
"@type": "BlogPosting",
"headline": "Ubuntu Üzerine Nginx ile Web Server Kurma",
"datePublished": "2015-04-29T18:37:25+03:00",
"description": "Kuracağımız sistem tamamen performansa yönelik olacak bunu baştan belirteyim yapımızı Nginx ile kuracağız uzatmadan detaylara geçelim ve",
"url": "https://mertcangokgoz.com/ubuntu-uzerine-nginx-ile-web-server-kurma/"}</script>
<!-- End Jekyll SEO tag -->

  
  <meta name="author" content="Mertcan GÖKGÖZ" />
  <meta name="distribution" content="global"/>
  <meta name="robots" content="follow, all"/>
  <meta name="google-site-verification" content="72uYg4UxAer0YwWdtkU93OGqjNq7ZThpqe0M4KxyvIg"/>
  <meta name='yandex-verification' content='410f2e33fe81ce80'/>
  <meta name="msvalidate.01" content="2183CAED5258723C183F825A20DF9C4A"/>
  <link rel="alternate" type="application/rss+xml" title="Mertcan GÖKGÖZ" href="https://mertcangokgoz.com/feed" />
  <link rel="stylesheet" type="text/css" media="screen" href="/assets/css/all.css">
  <link rel="stylesheet" type="text/css" media="print" href="/assets/css/print.css">
  <link rel="stylesheet" type="text/css" href="/assets/css/font-awesome.min.css">
  <script type="text/javascript" src="/assets/js/jquery-1.12.4.min.js"></script>
  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
  <link rel="shortcut icon" href="/favicon.png">
  <link rel="apple-touch-icon-precomposed" href="/apple-touch-icon-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/apple-touch-icon-72x72-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/apple-touch-icon-114x114-precomposed.png">
</head>
<body>
<div class="container">
    <div class="three columns sidebar">
      <nav class="nav">
  <a href="/">
    <img src="/YeniResimBro.jpg" id="gravatar" alt="Mertcan GÖKGÖZ" width="200" height="200"/>
  </a>
  <h3><a href="/">Mertcan GÖKGÖZ</a></h3>
  <div id="bio">
    <p>
        Kategoriler:<br>

        <a href="/category/linux">Linux</a> &raquo; 232 Yazı<br><a href="/category/programlama">Programlama</a> &raquo; 79 Yazı<br><a href="/category/genel">Genel</a> &raquo; 69 Yazı<br><a href="/category/guvenlik">Guvenlik</a> &raquo; 54 Yazı<br><a href="/category/windows">Windows</a> &raquo; 36 Yazı<br><a href="/category/analiz">Analiz</a> &raquo; 21 Yazı<br><a href="/category/jekyll">Jekyll</a> &raquo; 16 Yazı<br><a href="/category/nginx">Nginx</a> &raquo; 15 Yazı<br><a href="/category/egitimler">Egitimler</a> &raquo; 6 Yazı<br>
        <br>
        Arkadaşlar:<br>
        <a href="https://oztaser.com/" target="_blank" rel="nofollow">Adil ÖZTAŞER</a><br>
        <a href="https://aligoren.com/" target="_blank" rel="nofollow">Ali GÖREN</a><br>
        <a href="https://www.ceyhanmolla.com/" target="_blank" rel="nofollow">Ceyhan MOLLA</a><br>
        <a href="https://0x6.pw/" target="_blank" rel="nofollow">Enes ERGÜN</a><br>
        <a href="http://furkankalkan.com/" target="_blank" rel="nofollow">Furkan KALKAN</a><br>
        <a href="http://www.hamdicatal.com/" target="_blank" rel="nofollow">Hamdi ÇATAL</a><br>
        <a href="https://onur.im/" target="_blank" rel="nofollow">Onur ASLAN</a><br>
        <a href="http://www.omeripek.com.tr" target="_blank" rel="nofollow">Ömer IPEK</a><br>
        <a href="https://yapaygerizeka.github.io/" target="_blank" rel="nofollow">Yapay Geri Zekâ</a><br>
    </p>
  </div>
  <div id="social">
    Takip Edin:
<div id="stalker">
   

   
   <a title="MertcanGokgoz on Academia" href="https://baskent.academia.edu/MertcanGokgoz" target="_blank" rel="nofollow">
     <i class="fa fa-book"></i>
   </a>
   

  
  <a title="MertcanGokgoz on Github" href="https://github.com/MertcanGokgoz" target="_blank" rel="nofollow">
    <i class="fa fa-github-square"></i>
  </a>
  

  
  <a title="MertcanGokgoz on Gitlab" href="https://gitlab.com/u/MertcanGokgoz" target="_blank" rel="nofollow">
    <i class="fa fa-gitlab"></i>
  </a>
  

  

  

  

  

  

  
  <a title="mertcangokgoz on Twitter" href="https://twitter.com/mertcangokgoz" target="_blank" rel="nofollow">
    <i class="fa fa-twitter-square"></i>
  </a>
  

  

  

  
  <a title="Mertcan GÖKGÖZ on LinkedIn" href="https://www.linkedin.com/in/mertcangokgoz" target="_blank" rel="nofollow">
    <i class="fa fa-linkedin-square"></i>
  </a>
  

  
  <a title="Mertcan GÖKGÖZ on Google Plus" href="https://plus.google.com/103305118431759296457" target="_blank" rel="nofollow">
    <i class="fa fa-google-plus-square"></i>
  </a>
  

  

  
  <a title="Mertcan GÖKGÖZ on Youtube" href="https://www.youtube.com/c/MertcanGokgoz" target="_blank" rel="nofollow">
    <i class="fa fa-youtube"></i>
  </a>
  

  
  <a title="RSS feed" id="atom" href="/feed/">
    <i class="fa fa-rss-square"></i>
  </a>
  
</div>

  </div>
</nav>

    </div>
    <div class="nine columns content">
        <div class="menuM">
    <ul class="topnav">
        <li><a class="active" href="https://mertcangokgoz.com/">Anasayfa</a></li>
        <li><a href="https://mertcangokgoz.com/category/analiz/">Analiz</a></li>
        <li><a href="https://mertcangokgoz.com/category/genel/">Genel</a></li>
        <li><a href="https://mertcangokgoz.com/category/guvenlik/">Güvenlik</a></li>
        <li><a href="https://mertcangokgoz.com/category/linux/">Linux</a></li>
        <li><a href="https://mertcangokgoz.com/category/windows/">Windows</a></li>
        <li><a href="https://mertcangokgoz.com/category/jekyll/">Jekyll</a></li>
        <li><a href="https://mertcangokgoz.com/category/nginx/">Nginx</a></li>
        <li><a href="https://mertcangokgoz.com/category/egitimler/">Egitimler</a></li>
        <li><a href="https://mertcangokgoz.com/category/programlama/">Programlama</a></li>
        <li class="icon">
            <a href="javascript:void(0);" style="font-size:15px;" onclick="myFunction()"><i class="fa fa-bars"></i></a>
        </li>
    </ul>
</div>

<script>
    function myFunction() {
        document.getElementsByClassName("topnav")[0].classList.toggle("responsive");
    }
</script>


<p class="meta">
  April 29, 2015
  <a href="/">
    <i class="home fa fa-home fa-2x"></i>
  </a>
  <a href="/search/">
    <i class="home fa fa-search fa-2x"></i>
  </a>
  <a href="javascript:" onclick="window.print();return false;">
    <i class="home fa fa-print fa-2x"></i>
  </a>
</p>

<h1 class="title">Ubuntu Üzerine Nginx ile Web Server Kurma</h1>

<div id="post">
  <p>Böyle bir makaleyi yazmak için uzun zamandır bekledim testler yaptım ve yeni paketler derledim sonrasında güzel bir şekilde kurulumu anlatacak vakti ve tecrübeye sahip oldum normalde böylesine güzel bir configureyi açıklamayı düşünmüyordum ancak bilgi paylaşınca daha bir değerli olur.Kuracağımız sistem tamamen performansa yönelik olacak bunu baştan belirteyim Alt yapımızı Nginx ile kuracağız uzatmadan detaylara geçelim</p>

<p>Özellikler ve Modüller</p>

<p><strong>Kurulacak olan uygulamalar en son sürümlere göre kurulmuş ve ayarlanmıştır.</strong></p>

<ul>
  <li>Nginx
    <ul>
      <li>ngx_pagespeed</li>
      <li>Naxsi</li>
      <li>headers-more-nginx-module</li>
      <li>ngx_cache_purge</li>
    </ul>
  </li>
  <li>MariaDB</li>
  <li>Varnish</li>
  <li>Memcache</li>
  <li>PHP-FPM</li>
</ul>

<p>Şeklinde Bir yapı oluşturdum genelde nginx derleme konusunda millet sıkıntı çektiği için bende ubuntu için derleyip kurulum paketi oluşturdum tek yapmanız gereken normal komutlar ile kurulumu gerçekleştirmek</p>

<div class="highlighter-rouge"><pre class="highlight"><code>#Nginx 1.6.3 Sürümü İçin
wget https://mertcangokgoz.com/Downloads/nginx-moduler-mertcangokgoz.com-1.6.3.deb

#Nginx 1.8.0 Sürümü İçin
wget https://mertcangokgoz.com/Downloads/nginx-moduler-mertcangokgoz.com-1.8.0.deb
</code></pre>
</div>

<p>Olarak dosyamızı çekiyoruz Sonra gerekli olan kurulum ve diğer işlemlerde sıra</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo apt-get install -y dpkg-dev
sudo dpkg --install nginx-moduler-mertcangokgoz.com-*.deb
</code></pre>
</div>

<p>Kurulum başarıyla tamamlandıysa aşağıdaki komutu çalıştırıp nginx sürümüne ve modullere bakabilirsiniz.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>2&gt;&amp;1 nginx -V | tr ' ' 'n'
</code></pre>
</div>

<p>Örnek çıktı olarak ise</p>

<p><img src="/assets/nginxwebserverkurulumugorsel1-e1430318047561.png" alt="nginxwebserverkurulumugorsel1" /></p>

<p>Kurulumdan sonra nginx için dosya yolumuz <strong>/etc/nginx/</strong> olarak kullanılacaktır.Ayarlamalarımızı bu klasör içerisindeki dosyalarda yapacağız.İlk olarak kullanacağımız site için dosya yolu oluşturalım bunun için</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo mkdir -p /home/www/mertcangokgoz.com/
</code></pre>
</div>

<p>Dosya yolumuzu ayarladıktan sonra nginx içerisinde ayar dosyamızı tanımlayalım.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>cd etc/nginx/sites-available/
nano -w mertcangokgoz.com
</code></pre>
</div>

<p>İçerisine kullanacağınız ayarlamaları ve yapacağımız performans düzenlemelerini ekleyeceğiz.Örnek olarak şuanda hali hazırda benim bu site için kullandığım ayarlamaları paylaşacağım</p>

<div class="highlighter-rouge"><pre class="highlight"><code>##
# You should look at the following URL's in order to grasp a solid understanding
# of Nginx configuration files in order to fully unleash the power of Nginx.
# http://wiki.nginx.org/Pitfalls
# http://wiki.nginx.org/QuickStart
# http://wiki.nginx.org/Configuration
#
# Generally, you will want to move this file somewhere, and start with a clean
# file but keep this around for reference. Or just disable in sites-enabled.
#
# Please see /usr/share/doc/nginx-doc/examples/ for more detailed examples.
##

# Default server configuration
#
server {
	listen 8080 default_server;
	listen [::]:8080 ipv6only=on default_server;



        listen 443 ssl spdy;
        listen [::]:443 ipv6only=on ssl spdy;
        server_name mertcangokgoz.com;

        ssl_dhparam /etc/nginx/ssl_certs/dhparam.pem;
        ssl_certificate /etc/nginx/ssl_certs/mertcangokgoz.com.crt;
        ssl_certificate_key /etc/nginx/ssl_certs/www_mertcangokgoz_com.key;


        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
        ssl_session_cache shared:SSL:20m;
        ssl_session_timeout 10m;
        ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:CAMELLIA:DES-CBC3-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!aECDH:!EDH-DSS-DES-CBC3-SHA:!EDH-RSA-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA:!CAMELLIA;
	ssl_prefer_server_ciphers on;

	add_header Alternate-Protocol 443:npn-spdy/3;
        add_header Strict-Transport-Security "max-age=31536000; includeSubdomains;";
	add_header Access-Control-Allow-Origin "*";
        add_header Access-Control-Allow-Credentials "true";
	add_header X-XSS-Protection "1; mode=block";
	add_header X-Frame-Options SAMEORIGIN;
        add_header X-Content-Type-Options "nosniff";
	#add_header Last-Modified $time_stamp_of_uri
	#add_header Last-Modified "";
	#add_header ETag "";

	more_set_headers "Server: MertcanGokgoz";
        #add_header X-Frame-Options DENY;

	spdy_headers_comp 6;
        # ssl_buffer_size 4k;

        # enable ocsp stapling
        resolver 8.8.8.8;
        ssl_stapling on;
        ssl_stapling_verify on;
        ssl_trusted_certificate /etc/nginx/ssl_certs/mertcantr.crt;


	root /home/www/mertcangokgoz.com;

	# Add index.php to the list if you are using PHP
	index index.php index.html index.htm;

	location ~* .(eot|ttf|woff)$ {
    		add_header Access-Control-Allow-Origin *;
	}

	location / {
		index index.php index.html index.htm;
		try_files $uri $uri/ /index.php?$args;
	}

    	error_page 404 /404.html;
    	error_page 500 502 503 504 /50x.html;
    	location = /50x.html {
        	root /usr/share/nginx/html;
   	 }

	location ~* .(js|css|png|jpg|jpeg|gif|ico)$ {
        	expires max;
        	log_not_found off;
    	}

	location = /favicon.ico {
		log_not_found off;
		access_log off;
	}

	location = /robots.txt {
		allow all;
		log_not_found off;
		access_log off;
	}

	location ~ /(.|wp-config.php|readme.html|license.txt) {
		return 404;
	}

	# Prevent clients from accessing hidden files (starting with a dot)
	# This is particularly important if you store .htpasswd files in the site hierarchy
	location ~* (?:^|/). {
 	 	 deny all;
	}

	# Prevent clients from accessing to backup/config/source files
	location ~* (?:.(?:bak|config|sql|fla|psd|ini|log|inc|swp|dist)|~)$ {
    		deny all;
	}

	location ~ /. {
		deny all;
		access_log off;
		log_not_found off;
	}

	location /ngx_pagespeed_statistics { allow 127.0.0.1; deny all; }
	location /ngx_pagespeed_global_statistics { allow 127.0.0.1; deny all; }
	location /ngx_pagespeed_message { allow 127.0.0.1; deny all; }
	location /pagespeed_console { allow 127.0.0.1; deny all; }
	location ~ ^/pagespeed_admin { allow 127.0.0.1; deny all; }
	location ~ ^/pagespeed_global_admin { allow 127.0.0.1; deny all; }

   	 location ~ .php$ {
        	try_files $uri =404;
        	fastcgi_split_path_info ^(.+.php)(/.+)$;
        	fastcgi_pass unix:/var/run/php5-fpm.sock;
        	fastcgi_index index.php;
		include fastcgi.conf;
	}

	###Costum Rules####
	include global/cache.conf;
	include global/pagespeed.conf;
	include global/w3.conf;
	include global/proxy.conf;
	include global/status.conf;

	location ~ /.ht {
		deny all;
	}

}
</code></pre>
</div>

<p>Kayıt edip çıktıktan sonra sıra <strong>/etc/nginx/</strong> yolundaki <strong>nginx.conf</strong> dosyasını düzenlemeye geliyor.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>user www-data;
worker_processes auto;
worker_rlimit_nofile 8192;
pid /run/nginx.pid;

events {
	worker_connections 800;
	multi_accept on;
	use epoll;
}

http {

	##
	# Basic Settings
	##

	etag on;
	sendfile on;
	#tcp_nopush on;
	tcp_nodelay on;
	keepalive_timeout 65;
	client_body_timeout 30;
	client_header_timeout 30;
	send_timeout 30;
	client_max_body_size 100M;
	reset_timedout_connection on;
	types_hash_max_size 2048;
	server_tokens off;



	open_file_cache max=5000 inactive=20s;
        open_file_cache_valid 30s;
        open_file_cache_min_uses 2;
        open_file_cache_errors on;

	# server_names_hash_bucket_size 64;
	# server_name_in_redirect off;

	include /etc/nginx/mime.types;
	default_type application/octet-stream;

	##
	# SSL Settings
	##

	ssl_protocols TLSv1 TLSv1.1 TLSv1.2; # Dropping SSLv3, ref: POODLE
	ssl_prefer_server_ciphers on;

	##
	# Logging Settings
	##

	access_log /var/log/nginx/access.log;
	error_log /var/log/nginx/error.log;

	set_real_ip_from 127.0.0.1;
	real_ip_header X-Forwarded-For;
	log_format main '$remote_addr - $remote_user [$time_local] $status '
		'"$request" $body_bytes_sent "$http_referer" '
    		'"$http_user_agent" "$http_x_forwarded_for"';

	##
	# Gzip Settings
	##

	gzip on;
	gzip_disable "MSIE [1-6].(?!.*SV1)";

	gzip_vary on;
	gzip_static on;
	gzip_proxied any;
	gzip_comp_level 5;
	gzip_min_length	256;
	gzip_buffers 16 8k;
	gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript application/javascript text/x-js;

	##
	# Virtual Host Configs
	##

	#include /etc/nginx/conf.d/*.conf;
	include /etc/nginx/global/blacklist.conf;
	include /etc/nginx/sites-available/*;
}
</code></pre>
</div>

<p>Şimdi sıra geldi MariaDB kurulumuna komutlarımızı veriyoruz.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo apt-get install software-properties-common
sudo apt-key adv --recv-keys --keyserver hkp://keyserver.ubuntu.com:80 0xcbcb082a1bb943db
sudo add-apt-repository 'deb ftp://ftp.ulak.net.tr/pub/MariaDB/repo/10.0/ubuntu utopic main'
sudo apt-get update
sudo apt-get install mariadb-server mariadb-client
</code></pre>
</div>

<p>Kuruluma başlar başlamaz bir kaç işden sonra yönetici için şifre oluşturmamızı isteyecek benden size tavsiye minimum 16 karakterden oluşan random bir şifre koymanız tabi bunu kayıt etmeyi unutmayın sonrasında başınız ağrımasın.Sıra geldi PHP kurulumuna bunun için</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo apt-get install php5 php5-fpm php5-mysql
</code></pre>
</div>

<p>Kurulumumuzu tamamlıyoruz ufak tefek ayarlamalara kaldık php.ini içerisinde aşağıdaki ayarları uygulayın</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo nano /etc/php5/fpm/php.ini
</code></pre>
</div>

<p>Dosya içerisinde “cgi.fix_pathinfo=1” arıyorsunuz sonrasında değeri aşağıdaki gibi değiştiriyorsunuz.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>cgi.fix_pathinfo=0
</code></pre>
</div>

<p>Kayıt edip çıktıktan sonra php yeniden başlatmamız gerekiyor.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo service php5-fpm restart
</code></pre>
</div>

<p>Şimdi kurulumlardan çoğunu bitirdik  <strong>/etc/nginx/sites-available/</strong> kısmına test için bi ayarlama yapalım</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo nano /etc/nginx/sites-available/default
</code></pre>
</div>

<p>Dosya içerisine aşağıdakileri direk olarak ekleyiniz test için bu ayarlamalar yetecektir.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>server {
        listen 80;


        root /usr/share/nginx/www;
        index index.php index.html index.htm;

        server_name example.com;

        location / {
                try_files $uri $uri/ /index.html;
        }

        error_page 404 /404.html;

        error_page 500 502 503 504 /50x.html;
        location = /50x.html {
              root /usr/share/nginx/www;
        }

        # pass the PHP scripts to FastCGI server listening on the php-fpm socket
        location ~ .php$ {
                try_files $uri =404;
                fastcgi_pass unix:/var/run/php5-fpm.sock;
                fastcgi_index index.php;
                fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
                include fastcgi_params;

        }

}
</code></pre>
</div>

<p>test için bi php info dosyası oluşturalım ve ip adresinden erişip durumları kontrol edelim.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo nano /usr/share/nginx/www/info.php
</code></pre>
</div>

<p>dosya içerisine</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;?php
phpinfo();
?&gt;
</code></pre>
</div>

<p>şimdi bir nginx web serverını yeniden başlatalım</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo service nginx restart
</code></pre>
</div>

<p>Şimdi Header sorgulaması yapıyoruz bakıyoruz ki sistemde pagespeed aktif değil hemen gerekenleri yapıyoruz. <strong>/etc/nginx/sites-available</strong> yolundaki ayar dosyamızın içerisinde alt kısımlara doğru fark bir satır ekleyeceğiz aslında tüm .confları bu şekilde eklememiz daha doğru olacak</p>

<div class="highlighter-rouge"><pre class="highlight"><code>include global/pagespeed.conf;
</code></pre>
</div>

<p>bu satırı ekledikten sonra kayıt edip çıkıyorsunuz.Dosyayı oluşturmadıysanız şu şekilde gerekeni yapabilirsiniz.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo nano -w /global/pagespeed.conf
</code></pre>
</div>

<p>içerisine direk olarak aşağıdaki satırları yapıştırıyorsunuz.</p>

<div class="highlighter-rouge"><pre class="highlight"><code># Turning the module on and off
pagespeed on;

# Configuring PageSpeed Filters
pagespeed RewriteLevel PassThrough;

# Needs to exist and be writable by nginx. Use tmpfs for best performance.
pagespeed MemcachedThreads 1;
pagespeed MemcachedServers "127.0.0.1:11211";
pagespeed MemcachedTimeoutUs 100000;
pagespeed FileCachePath /var/cache/ngx_pagespeed/;
pagespeed RunExperiment on;
pagespeed ExperimentVariable 1;
pagespeed ExperimentSpec "id=1;percent=50;level=CoreFilters;enabled=collapse_whitespace,remove_comments;";
pagespeed EnableFilters insert_ga;
pagespeed AnalyticsID Google Takip Kodunuz;
pagespeed EnableFilters make_google_analytics_async;

# Costum
pagespeed FileCacheSizeKb 102400;
pagespeed FileCacheCleanIntervalMs 3600000;
pagespeed FileCacheInodeLimit 500000;

#images rules
pagespeed PreserveUrlRelativity on;
pagespeed MaxCombinedCssBytes -1;
pagespeed ImageResolutionLimitBytes 16777216;
pagespeed MaxSegmentLength 250;
pagespeed CombineAcrossPaths off;

#default betas
pagespeed AvoidRenamingIntrospectiveJavascript on;
pagespeed ImageInlineMaxBytes 3072;
pagespeed CssImageInlineMaxBytes 0;
pagespeed MaxInlinedPreviewImagesIndex -1;
pagespeed MinImageSizeLowResolutionBytes 3072;

#pagespeed StatisticsPath /ngx_pagespeed_statistics;
#pagespeed GlobalStatisticsPath /ngx_pagespeed_global_statistics;
#pagespeed MessagesPath /ngx_pagespeed_message;
#pagespeed ConsolePath /pagespeed_console;
#pagespeed AdminPath /pagespeed_admin;
#pagespeed GlobalAdminPath /pagespeed_global_admin;

#Filter Settings
pagespeed RewriteLevel CoreFilters;
pagespeed EnableFilters collapse_whitespace,remove_comments;

# PageSpeed Cache Purge
pagespeed EnableCachePurge on;
pagespeed PurgeMethod PURGE;

# enable collapse whitespace filter
pagespeed EnableFilters collapse_whitespace;

# enable JavaScript library offload
pagespeed EnableFilters canonicalize_javascript_libraries;

# combine multiple CSS files into one
pagespeed EnableFilters combine_css;

# combine multiple JavaScript files into one
pagespeed EnableFilters combine_javascript;

# remove tags with default attributes
pagespeed EnableFilters elide_attributes;

# improve resource cacheability
pagespeed EnableFilters extend_cache;

# flatten CSS files by replacing @import with the imported file
pagespeed EnableFilters flatten_css_imports;
pagespeed CssFlattenMaxBytes 5120;

# defer the loading of images which are not visible to the client
pagespeed EnableFilters lazyload_images;

# enable JavaScript minification
pagespeed EnableFilters rewrite_javascript;

# enable image optimization
pagespeed EnableFilters rewrite_images;

# pre-solve DNS lookup
pagespeed EnableFilters insert_dns_prefetch;

# rewrite CSS to load page-rendering CSS rules first.
pagespeed EnableFilters prioritize_critical_css;

#pagespeed InPlaceResourceOptimization off;
pagespeed ModifyCachingHeaders off;
</code></pre>
</div>

<p>Cache için dizin oluşturuyoruz.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo mkdir -p /var/cache/ngx_pagespeed/
</code></pre>
</div>

<p>Şimdi ayarlamalar doğrumu bir bakalım test komutunu veriyoruz.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo service nginx configtest

yada

nginx -t
</code></pre>
</div>

<p>Örnek Olarak çıktımız şu şekilde</p>

<p><img src="/assets/nginxtestgorsel1-e1430320632111.png" alt="nginxtestgorsel1" /></p>

<p>Sıra Geldi Varnish kurulumuna Sırasıyla aşağıdaki komutları uygulayın</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo apt-get install apt-transport-https
curl https://repo.varnish-cache.org/GPG-key.txt | apt-key add -
echo "deb https://repo.varnish-cache.org/ubuntu/ precise varnish-4.0" &gt;&gt; /etc/apt/sources.list.d/varnish-cache.list
sudo apt-get update
sudo apt-get install varnish
</code></pre>
</div>

<p>Kurulum başarılı bir şekilde tamamlandığı zaman sistem içerisinde  <strong>/etc/default/</strong> yolunu takip ediyoruz.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo nano /etc/default/varnish
</code></pre>
</div>

<p>içerisinde deamon kısmında 8080 yazıyor olacak bunu aşağıdaki gibi değiştiriyorsunuz.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>DAEMON_OPTS="-a :80
             -T localhost:6082
             -f /etc/varnish/default.vcl
             -S /etc/varnish/secret
             -s malloc,256m"
</code></pre>
</div>

<p>şimdi default.vlc içerisindeki ayarlamayı yapalım <strong>/etc/varnish/</strong> yolunu takip ederek</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo nano /etc/varnish/default.vcl
</code></pre>
</div>

<p>üstlerdeki backend satırını aşağıdaki gibi düzenleyiniz.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>backend default {
    .host = "127.0.0.1";
    .port = "8080";
}
</code></pre>
</div>

<p>Eğer yukarıdaki nginx ayar dosyalarını kullanıyorsanız bu kurulum sonrasında varnish sapa sağlam bir şekilde çalışacaktır.Ayarlamalardan sonra servisi yeniden başlatınız.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo service varnish restart
</code></pre>
</div>

<p>Memcache kurulumu için ise</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo apt-get update
sudo apt-get install php5-memcached memcached
</code></pre>
</div>

<p>Yukarda anlatılan ve yapılanların hepsi Wordpress kullanacaklar için özenle hazırlanmıştır wordpress haricinde web sitesi kuracaksanız site ayarlamalarında ufak değişiklikler yapmanız gerekmektedir.Yardım gerekir ise <a href="https://mertcangokgoz.com/soru-cevap/">lütfen iletişime geçiniz</a></p>

</div>

<div id="paylasim">
<h3>Bu yazıyı paylaş:</h3>
<a href="https://www.facebook.com/sharer/sharer.php?u=https://mertcangokgoz.com/ubuntu-uzerine-nginx-ile-web-server-kurma/" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" >
    <i class="fa fa-facebook-square fa share-button"> Facebook</i>
</a>
<a href="https://twitter.com/intent/tweet?text=Ubuntu Üzerine Nginx ile Web Server Kurma&url=https://mertcangokgoz.com/ubuntu-uzerine-nginx-ile-web-server-kurma/&via=mertcangokgoz&related=mertcangokgoz" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;">
    <i class="fa fa-twitter-square fa share-button"> Twitter</i>
</a>
<a href="https://plus.google.com/share?url=https://mertcangokgoz.com/ubuntu-uzerine-nginx-ile-web-server-kurma/" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" >
    <i class="fa fa-google-plus-square fa share-button"> Google</i>
</a>
<a href="http://www.reddit.com/submit?url=https://mertcangokgoz.com/ubuntu-uzerine-nginx-ile-web-server-kurma/&title=Ubuntu Üzerine Nginx ile Web Server Kurma" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;" >
    <i class="fa fa-reddit-square fa share-button"> Reddit</i>
</a>
<a href="https://www.linkedin.com/shareArticle?mini=true&url=https://mertcangokgoz.com/ubuntu-uzerine-nginx-ile-web-server-kurma/&title=Ubuntu Üzerine Nginx ile Web Server Kurma&summary=&source=webjeda" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" >
    <i class="fa fa-linkedin-square fa share-button"> Linkedin</i>
</a>
<a href="mailto:?subject=Ubuntu Üzerine Nginx ile Web Server Kurma&amp;body=Check out this site https://mertcangokgoz.com/ubuntu-uzerine-nginx-ile-web-server-kurma/">
    <i class="fa fa-envelope-square fa share-button"> Email</i>
</a>
</div>


<div class="ajaxloadcomment"><button class="show-comments">Yorumları yükle</button></div>
<div itemprop="comment" id="disqus_thread"></div>
<script>
$(document).ready(function() {
    $('.show-comments').on('click', function(){
          var disqus_shortname = 'mertcanofficial';

          $.ajax({
                  type: "GET",
                  url: "//" + disqus_shortname + ".disqus.com/embed.js",
                  dataType: "script",
                  cache: true
          });
          $(this).fadeOut();
    });
});
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>



      <div class="footer">
        <div class="disclaimer">
  
  <p>
    Bu sitedeki gönderiler bana aittir ve iş verenime ait pozisyonlar,
    stratejiler veya görüşler temsil edilmemektedir.<br>
        <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Atıf-Paylaşım Lisansı</a> altındadır.<br>
        <a href="/ders-notlari/">Ders Notları</a>
        <span> | </span><a href="/gizlilik-politikasi/">Gizlilik Politikası</a>
        <span> | </span><a href="/kullanim-kosullari/">Kullanım Koşulları</a>
        <span> | </span><a href="/hakkimda/">Hakkımda</a>
        <span> | </span><a href="/iletisim/">İletişim</a><br>
        <b>BTC:</b> 36DFx4anTdsx3AnBiA1oqR3oHkMV3RJME1<br>
        <a href="/hosted/">Hosted By </a> © Mertcan GÖKGÖZ, 2016 - Linux Hacısı
  </p>
  
</div>

      </div>
    </div>
  </div>
  <div id="up">
    <a href="javascript:"><i class="fa fa-arrow-up fa-2x"></i></a>
  </div>







</body>
</html>
